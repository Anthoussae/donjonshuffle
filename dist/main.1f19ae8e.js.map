{"version":3,"sources":["main.js"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","_toConsumableArray","r","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","a","_arrayLikeToArray","t","toString","call","slice","name","Array","from","test","isArray","length","e","n","ownKeys","Object","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","i","_toPrimitive","toPrimitive","String","Number","cardList","roomName","attack","curse","trap","itemName","armor","ward","detectTraps","copies","injuresOnLoot","heals","consumable","autoUseOnLoot","effectOnRoomReveal","effect","hpLoss","createInitialState","phase","log","deckPile","discardPile","roomPile","itemPile","lootPile","selectionPile","levelTrackerPile","tempBuffs","characterSheet","hp","newGame","state","card","shuffle","splice","console","countCards","unshift","advanceLevel","newState","shift","concat","render","cardTotal","array","j","Math","floor","random","_ref5","calculateDangerOutcome","total","reduce","acc","room","dangerDiff","danger","stat","max","diffAttack","diffCurse","diffTrap","totalIncoming","logMessage","threats","stats","diff","death","explore","numToDraw","min","faceDown","checkRoomRevealTriggers","index","applyRoomRevealEffect","checkRoomRevealTriggersForRoomPile","cursedNames","cursedIndex","findIndex","item","includes","discardedItem","randomIndex","itemDropTriggerCheck","checkDeath","stairCollapseDamage","hasAshes","some","hasCoals","cursedItems","selectRoomFromPile","selectedRoom","unchosenRooms","venture","secretRoom","damageTaken","map","join","loot","discardedRoom","pickItem","selectedItem","itemPickupTriggerCheck","useConsumable","itemIndex","removed","output","document","getElementById","innerHTML","headerDiv","createElement","className","title","textContent","subtitle","appendChild","levelDiv","statsDiv","equipment","consumables","equipmentDiv","props","line","consumablesDiv","btn","onclick","indexOf","floorDiv","floorTable","row","selectionDiv","cardDiv","lines","lootDiv","itemDiv","buttonDiv","exploreBtn","disabled","ventureBtn","logDiv","logMessages","msg","logEntry","classList","add","style","opacity","newGameDiv","newGameBtn","querySelectorAll","entry","el","color","window","onload"],"mappings":"AAAA,YAAY;;AAAC,SAAAA,QAAAC,CAAA,sCAAAD,OAAA,wBAAAE,MAAA,uBAAAA,MAAA,CAAAC,QAAA,aAAAF,CAAA,kBAAAA,CAAA,gBAAAA,CAAA,WAAAA,CAAA,yBAAAC,MAAA,IAAAD,CAAA,CAAAG,WAAA,KAAAF,MAAA,IAAAD,CAAA,KAAAC,MAAA,CAAAG,SAAA,qBAAAJ,CAAA,KAAAD,OAAA,CAAAC,CAAA;AAAA,SAAAK,mBAAAC,CAAA,WAAAC,kBAAA,CAAAD,CAAA,KAAAE,gBAAA,CAAAF,CAAA,KAAAG,2BAAA,CAAAH,CAAA,KAAAI,kBAAA;AAAA,SAAAA,mBAAA,cAAAC,SAAA;AAAA,SAAAF,4BAAAH,CAAA,EAAAM,CAAA,QAAAN,CAAA,2BAAAA,CAAA,SAAAO,iBAAA,CAAAP,CAAA,EAAAM,CAAA,OAAAE,CAAA,MAAAC,QAAA,CAAAC,IAAA,CAAAV,CAAA,EAAAW,KAAA,6BAAAH,CAAA,IAAAR,CAAA,CAAAH,WAAA,KAAAW,CAAA,GAAAR,CAAA,CAAAH,WAAA,CAAAe,IAAA,aAAAJ,CAAA,cAAAA,CAAA,GAAAK,KAAA,CAAAC,IAAA,CAAAd,CAAA,oBAAAQ,CAAA,+CAAAO,IAAA,CAAAP,CAAA,IAAAD,iBAAA,CAAAP,CAAA,EAAAM,CAAA;AAAA,SAAAJ,iBAAAF,CAAA,8BAAAL,MAAA,YAAAK,CAAA,CAAAL,MAAA,CAAAC,QAAA,aAAAI,CAAA,uBAAAa,KAAA,CAAAC,IAAA,CAAAd,CAAA;AAAA,SAAAC,mBAAAD,CAAA,QAAAa,KAAA,CAAAG,OAAA,CAAAhB,CAAA,UAAAO,iBAAA,CAAAP,CAAA;AAAA,SAAAO,kBAAAP,CAAA,EAAAM,CAAA,aAAAA,CAAA,IAAAA,CAAA,GAAAN,CAAA,CAAAiB,MAAA,MAAAX,CAAA,GAAAN,CAAA,CAAAiB,MAAA,YAAAC,CAAA,MAAAC,CAAA,GAAAN,KAAA,CAAAP,CAAA,GAAAY,CAAA,GAAAZ,CAAA,EAAAY,CAAA,IAAAC,CAAA,CAAAD,CAAA,IAAAlB,CAAA,CAAAkB,CAAA,UAAAC,CAAA;AAAA,SAAAC,QAAAF,CAAA,EAAAlB,CAAA,QAAAQ,CAAA,GAAAa,MAAA,CAAAC,IAAA,CAAAJ,CAAA,OAAAG,MAAA,CAAAE,qBAAA,QAAA7B,CAAA,GAAA2B,MAAA,CAAAE,qBAAA,CAAAL,CAAA,GAAAlB,CAAA,KAAAN,CAAA,GAAAA,CAAA,CAAA8B,MAAA,WAAAxB,CAAA,WAAAqB,MAAA,CAAAI,wBAAA,CAAAP,CAAA,EAAAlB,CAAA,EAAA0B,UAAA,OAAAlB,CAAA,CAAAmB,IAAA,CAAAC,KAAA,CAAApB,CAAA,EAAAd,CAAA,YAAAc,CAAA;AAAA,SAAAqB,cAAAX,CAAA,aAAAlB,CAAA,MAAAA,CAAA,GAAA8B,SAAA,CAAAb,MAAA,EAAAjB,CAAA,UAAAQ,CAAA,WAAAsB,SAAA,CAAA9B,CAAA,IAAA8B,SAAA,CAAA9B,CAAA,QAAAA,CAAA,OAAAoB,OAAA,CAAAC,MAAA,CAAAb,CAAA,OAAAuB,OAAA,WAAA/B,CAAA,IAAAgC,eAAA,CAAAd,CAAA,EAAAlB,CAAA,EAAAQ,CAAA,CAAAR,CAAA,SAAAqB,MAAA,CAAAY,yBAAA,GAAAZ,MAAA,CAAAa,gBAAA,CAAAhB,CAAA,EAAAG,MAAA,CAAAY,yBAAA,CAAAzB,CAAA,KAAAY,OAAA,CAAAC,MAAA,CAAAb,CAAA,GAAAuB,OAAA,WAAA/B,CAAA,IAAAqB,MAAA,CAAAc,cAAA,CAAAjB,CAAA,EAAAlB,CAAA,EAAAqB,MAAA,CAAAI,wBAAA,CAAAjB,CAAA,EAAAR,CAAA,iBAAAkB,CAAA;AAAA,SAAAc,gBAAAd,CAAA,EAAAlB,CAAA,EAAAQ,CAAA,YAAAR,CAAA,GAAAoC,cAAA,CAAApC,CAAA,MAAAkB,CAAA,GAAAG,MAAA,CAAAc,cAAA,CAAAjB,CAAA,EAAAlB,CAAA,IAAAqC,KAAA,EAAA7B,CAAA,EAAAkB,UAAA,MAAAY,YAAA,MAAAC,QAAA,UAAArB,CAAA,CAAAlB,CAAA,IAAAQ,CAAA,EAAAU,CAAA;AAAA,SAAAkB,eAAA5B,CAAA,QAAAgC,CAAA,GAAAC,YAAA,CAAAjC,CAAA,gCAAAf,OAAA,CAAA+C,CAAA,IAAAA,CAAA,GAAAA,CAAA;AAAA,SAAAC,aAAAjC,CAAA,EAAAR,CAAA,oBAAAP,OAAA,CAAAe,CAAA,MAAAA,CAAA,SAAAA,CAAA,MAAAU,CAAA,GAAAV,CAAA,CAAAb,MAAA,CAAA+C,WAAA,kBAAAxB,CAAA,QAAAsB,CAAA,GAAAtB,CAAA,CAAAR,IAAA,CAAAF,CAAA,EAAAR,CAAA,gCAAAP,OAAA,CAAA+C,CAAA,UAAAA,CAAA,YAAAnC,SAAA,yEAAAL,CAAA,GAAA2C,MAAA,GAAAC,MAAA,EAAApC,CAAA;AAEb,IAAMqC,QAAQ,GAAG;AACf;AACA;EACEC,QAAQ,EAAE,mBAAmB;EAC7BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,SAAS;EACnBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,oBAAoB;EAC9BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,gBAAgB;EAC1BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,eAAe;EACzBC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,YAAY;EACtBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,oBAAoB;EAC9BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,OAAO;EACjBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC;AACD;AACA;EACER,QAAQ,EAAE,WAAW;EACrBC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,iBAAiB;EAC3BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,wBAAwB;EAClCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,cAAc;EACxBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,eAAe;EACzBC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,iBAAiB;EAC3BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC;AACD;AACA;EACER,QAAQ,EAAE,qBAAqB;EAC/BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,UAAU;EACpBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,kBAAkB;EAC5BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,WAAW;EACrBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,UAAU;EACpBC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,aAAa;EACvBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC;AACD;AACA;EACER,QAAQ,EAAE,cAAc;EACxBC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,iBAAiB;EAC3BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC,CAAC;EACRC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,kBAAkB;EAC5BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,cAAc;EACxBC,KAAK,EAAE,CAAC,CAAC;EACTC,IAAI,EAAE,CAAC,CAAC;EACRC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC;AACD;AACA;EACER,QAAQ,EAAE,gBAAgB;EAC1BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,iBAAiB;EAC3BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE,CAAC;EACTC,aAAa,EAAE,CAAC,CAAE;AACpB,CAAC,EACD;EACET,QAAQ,EAAE,kBAAkB;EAC5BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,aAAa;EACvBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,mBAAmB;EAC7BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,kBAAkB;EAC5BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,cAAc;EACxBC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,eAAe;EACzBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC;AACD;AACA;EACER,QAAQ,EAAE,eAAe;EACzBC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,uBAAuB;EACjCC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdG,KAAK,EAAE,CAAC;EACRC,UAAU,EAAE,IAAI;EAChBH,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,iBAAiB;EAC3BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,gBAAgB;EAC1BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdG,KAAK,EAAE,EAAE;EACTC,UAAU,EAAE,IAAI;EAChBH,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,yBAAyB;EACnCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,uBAAuB;EACjCC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdI,UAAU,EAAE,IAAI;EAChBH,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,gBAAgB;EAC1BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,gBAAgB;EAC1BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdG,KAAK,EAAE,CAAC;EACRC,UAAU,EAAE,IAAI;EAChBH,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,uBAAuB;EACjCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,uBAAuB;EACjCC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,GAAG;EACTC,WAAW,EAAE,CAAC;EACdI,UAAU,EAAE,IAAI;EAChBH,MAAM,EAAE;AACV,CAAC,EAED;EACER,QAAQ,EAAE,oBAAoB;EAC9BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,kBAAkB;EAC5BC,KAAK,EAAE,GAAG;EACVC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdI,UAAU,EAAE,IAAI;EAChBH,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,mBAAmB;EAC7BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,oBAAoB;EAC9BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,GAAG;EAChBI,UAAU,EAAE,IAAI;EAChBH,MAAM,EAAE;AACV,CAAC;AACD;AACA;EACER,QAAQ,EAAE,+BAA+B;EACzCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,cAAc;EACxBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,8BAA8B;EACxCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,cAAc;EACxBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,6BAA6B;EACvCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,mBAAmB;EAC7BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,0BAA0B;EACpCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,mBAAmB;EAC7BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdG,KAAK,EAAE,EAAE;EAAE;EACXE,aAAa,EAAE,IAAI;EACnBJ,MAAM,EAAE;AACV,CAAC,EACD;AAAAtB,eAAA,CAAAA,eAAA,CAAAA,eAAA;EAEEc,QAAQ,EAAE,oBAAoB;EAC9BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,eAAe;EACzBC,KAAK,EAAE,CAAC;AAAC,YACF,CAAC,kBACK,CAAC,aACN,CAAC,GAAAnB,eAAA,CAAAA,eAAA,CAAAA,eAAA;EAGTc,QAAQ,EAAE,uBAAuB;EACjCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,eAAe;EACzBC,KAAK,EAAE;AAAC,YACD,CAAC,CAAC,kBACI,CAAC,aACN,CAAC,GAAAnB,eAAA,CAAAA,eAAA,CAAAA,eAAA;EAGTc,QAAQ,EAAE,yBAAyB;EACnCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,qBAAqB;EAC/BC,KAAK,EAAE;AAAC,YACD,CAAC,kBACK,CAAC,CAAC,aACP,CAAC,GAAAnB,eAAA,CAAAA,eAAA,CAAAA,eAAA;EAGTc,QAAQ,EAAE,sBAAsB;EAChCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,mBAAmB;EAC7BC,KAAK,EAAE,CAAC;AAAC,YACF,CAAC,CAAC,kBACI,CAAC,CAAC,aACP,CAAC;AAEX;AACA;EACEL,QAAQ,EAAE,kBAAkB;EAC5BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPU,kBAAkB,EAAE,IAAI;EACxBC,MAAM,EAAE,iCAAiC;EACzCV,QAAQ,EAAE,OAAO;EACjBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,oBAAoB;EAC9BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPU,kBAAkB,EAAE,IAAI;EACxBC,MAAM,EAAE,iCAAiC;EACzCV,QAAQ,EAAE,MAAM;EAChBC,KAAK,EAAE,CAAC,CAAC;EACTC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,iBAAiB;EAC3BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,eAAe;EACzBK,aAAa,EAAE,CAAC;EAAE;EAClBJ,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,iBAAiB;EAC3BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,YAAY;EACtBC,KAAK,EAAE,CAAC,CAAC;EACTC,IAAI,EAAE,CAAC,CAAC;EACRC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,iBAAiB;EAC3BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,aAAa;EACvBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC,CAAC;EACRC,WAAW,EAAE,CAAC,CAAC;EACfC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,gBAAgB;EAC1BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,cAAc;EACxBC,KAAK,EAAE,CAAC,CAAC;EACTC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC,CAAC;EACfC,MAAM,EAAE;AACV,CAAC;AACD;AACA;EACER,QAAQ,EAAE,sBAAsB;EAChCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPU,kBAAkB,EAAE,IAAI;EACxBC,MAAM,EAAE,SAAS;EACjBC,MAAM,EAAE,CAAC;EACTX,QAAQ,EAAE,OAAO;EACjBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,uBAAuB;EACjCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPU,kBAAkB,EAAE,IAAI;EACxBC,MAAM,EAAE,SAAS;EACjBC,MAAM,EAAE,CAAC;EACTX,QAAQ,EAAE,SAAS;EACnBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,4BAA4B;EACtCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPU,kBAAkB,EAAE,IAAI;EACxBC,MAAM,EAAE,iBAAiB;EACzBV,QAAQ,EAAE,OAAO;EACjBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC;AACD;AACA;EACER,QAAQ,EAAE,aAAa;EACvBC,MAAM,EAAE,EAAE;EACVC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPU,kBAAkB,EAAE,IAAI;EACxBC,MAAM,EAAE,mCAAmC;EAC3CV,QAAQ,EAAE,aAAa;EACvBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,kBAAkB;EAC5BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPU,kBAAkB,EAAE,IAAI;EACxBC,MAAM,EAAE,sCAAsC;EAC9CV,QAAQ,EAAE,gBAAgB;EAC1BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,gBAAgB;EAC1BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,cAAc;EACxBC,KAAK,EAAE,CAAC,CAAC;EACTC,IAAI,EAAE,CAAC,CAAC;EACRC,WAAW,EAAE,CAAC,CAAC;EACfC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,0BAA0B;EACpCC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,cAAc;EACxBC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,EACD;EACER,QAAQ,EAAE,oBAAoB;EAC9BC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,QAAQ,EAAE,iBAAiB;EAC3BC,KAAK,EAAE,CAAC;EACRC,IAAI,EAAE,CAAC;EACPC,WAAW,EAAE,CAAC;EACdC,MAAM,EAAE;AACV,CAAC,CACF;AAED,SAASQ,kBAAkBA,CAAA,EAAG;EAC5B,OAAO;IACLC,KAAK,EAAE,SAAS;IAChBC,GAAG,EAAE,EAAE;IAEPC,QAAQ,EAAE,EAAE;IACZC,WAAW,EAAE,EAAE;IACfC,QAAQ,EAAE,EAAE;IACZC,QAAQ,EAAE,EAAE;IACZC,QAAQ,EAAE,EAAE;IACZC,aAAa,EAAE,EAAE;IACjBC,gBAAgB,EAAE,EAAE;IAEpBC,SAAS,EAAE;MACTrB,KAAK,EAAE,CAAC;MACRC,IAAI,EAAE,CAAC;MACPC,WAAW,EAAE;IACf,CAAC;IACDoB,cAAc,EAAE;MACdC,EAAE,EAAE,EAAE;MACNvB,KAAK,EAAE,CAAC;MACRC,IAAI,EAAE,CAAC;MACPC,WAAW,EAAE;IACf,CAAC;IAEDR,QAAQ,EAAEA;EACZ,CAAC;AACH;AAEA,SAAS8B,OAAOA,CAAA,EAAG;EACjB,IAAMC,KAAK,GAAGd,kBAAkB,CAAC,CAAC;;EAElC;EACAc,KAAK,CAAC/B,QAAQ,CAACd,OAAO,CAAC,UAAC8C,IAAI,EAAK;IAC/B,KAAK,IAAIrC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGqC,IAAI,CAACvB,MAAM,EAAEd,CAAC,EAAE,EAAE;MACpCoC,KAAK,CAACX,QAAQ,CAACtC,IAAI,CAAAE,aAAA,KAAMgD,IAAI,CAAE,CAAC;IAClC;EACF,CAAC,CAAC;;EAEF;EACAC,OAAO,CAACF,KAAK,CAACX,QAAQ,CAAC;EACvBW,KAAK,CAACV,WAAW,GAAGU,KAAK,CAACX,QAAQ,CAACc,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;;EAElDC,OAAO,CAAChB,GAAG,CAAC,+BAA+B,EAAEiB,UAAU,CAACL,KAAK,CAAC,EAAEA,KAAK,CAAC;EACtE;EACAA,KAAK,CAACZ,GAAG,CAACkB,OAAO,CAAC,yBAAyB,CAAC;EAC5CC,YAAY,CAACP,KAAK,CAAC;AACrB;AAEA,SAASO,YAAYA,CAACP,KAAK,EAAE;EAC3B,IAAIQ,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;;EAE3B;EACA,IAAIQ,QAAQ,CAACnB,QAAQ,CAAChD,MAAM,GAAG,CAAC,EAAE;IAChC,IAAI4D,IAAI,GAAGO,QAAQ,CAACnB,QAAQ,CAACoB,KAAK,CAAC,CAAC;IACpCD,QAAQ,CAACb,gBAAgB,CAAC5C,IAAI,CAACkD,IAAI,CAAC;IACpCG,OAAO,CAAChB,GAAG,CAAC,oBAAoB,GAAGoB,QAAQ,CAACb,gBAAgB,CAACtD,MAAM,CAAC;EACtE;;EAEA;EACA,IAAImE,QAAQ,CAACnB,QAAQ,CAAChD,MAAM,KAAK,CAAC,EAAE;IAClCmE,QAAQ,CAACrB,KAAK,GAAG,SAAS;IAC1BqB,QAAQ,CAACpB,GAAG,CAACkB,OAAO,mDAAAI,MAAA,CACgCF,QAAQ,CAACb,gBAAgB,CAACtD,MAAM,uCACpF,CAAC;IACDsE,MAAM,CAACH,QAAQ,CAAC;IAChB;EACF;;EAEA;EACAA,QAAQ,CAACrB,KAAK,GAAG,SAAS;EAC1BqB,QAAQ,CAACpB,GAAG,CAACkB,OAAO,sBAAAI,MAAA,CACGF,QAAQ,CAACb,gBAAgB,CAACtD,MAAM,MACvD,CAAC;EACD+D,OAAO,CAAChB,GAAG,sBAAAsB,MAAA,CACYF,QAAQ,CAACb,gBAAgB,CAACtD,MAAM,oBACrDgE,UAAU,CAACG,QAAQ,CAAC,EACpBA,QACF,CAAC;EACDG,MAAM,CAACH,QAAQ,CAAC;AAClB;;AAEA;AACA,SAASH,UAAUA,CAACL,KAAK,EAAE;EACzB,IAAIY,SAAS,GACXZ,KAAK,CAACX,QAAQ,CAAChD,MAAM,GACrB2D,KAAK,CAACV,WAAW,CAACjD,MAAM,GACxB2D,KAAK,CAACT,QAAQ,CAAClD,MAAM,GACrB2D,KAAK,CAACR,QAAQ,CAACnD,MAAM,GACrB2D,KAAK,CAACP,QAAQ,CAACpD,MAAM,GACrB2D,KAAK,CAACN,aAAa,CAACrD,MAAM,GAC1B2D,KAAK,CAACL,gBAAgB,CAACtD,MAAM;EAE/B,OAAOuE,SAAS;AAClB;;AAEA;AACA,SAASV,OAAOA,CAACW,KAAK,EAAE;EACtB,KAAK,IAAIjD,CAAC,GAAGiD,KAAK,CAACxE,MAAM,GAAG,CAAC,EAAEuB,CAAC,GAAG,CAAC,EAAEA,CAAC,EAAE,EAAE;IACzC,IAAMkD,CAAC,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,IAAIrD,CAAC,GAAG,CAAC,CAAC,CAAC;IAAC,IAAAsD,KAAA,GACvB,CAACL,KAAK,CAACC,CAAC,CAAC,EAAED,KAAK,CAACjD,CAAC,CAAC,CAAC;IAA1CiD,KAAK,CAACjD,CAAC,CAAC,GAAAsD,KAAA;IAAEL,KAAK,CAACC,CAAC,CAAC,GAAAI,KAAA;EACrB;AACF;AACA;AACA,SAASC,sBAAsBA,CAACnB,KAAK,EAAET,QAAQ,EAAE;EAC/C;EACA,IAAM6B,KAAK,GAAG7B,QAAQ,CAAC8B,MAAM,CAC3B,UAACC,GAAG,EAAEC,IAAI,EAAK;IACbD,GAAG,CAACnD,MAAM,IAAIoD,IAAI,CAACpD,MAAM,IAAI,CAAC;IAC9BmD,GAAG,CAAClD,KAAK,IAAImD,IAAI,CAACnD,KAAK,IAAI,CAAC;IAC5BkD,GAAG,CAACjD,IAAI,IAAIkD,IAAI,CAAClD,IAAI,IAAI,CAAC;IAC1B,OAAOiD,GAAG;EACZ,CAAC,EACD;IAAEnD,MAAM,EAAE,CAAC;IAAEC,KAAK,EAAE,CAAC;IAAEC,IAAI,EAAE;EAAE,CACjC,CAAC;;EAED;EACA,IAAME,KAAK,GAAGyB,KAAK,CAACH,cAAc,CAACtB,KAAK,GAAGyB,KAAK,CAACJ,SAAS,CAACrB,KAAK;EAChE,IAAMC,IAAI,GAAGwB,KAAK,CAACH,cAAc,CAACrB,IAAI,GAAGwB,KAAK,CAACJ,SAAS,CAACpB,IAAI;EAC7D,IAAMC,WAAW,GACfuB,KAAK,CAACH,cAAc,CAACpB,WAAW,GAAGuB,KAAK,CAACJ,SAAS,CAACnB,WAAW;;EAEhE;EACA,IAAM+C,UAAU,GAAG,SAAbA,UAAUA,CAAIC,MAAM,EAAEC,IAAI;IAAA,OAAKX,IAAI,CAACY,GAAG,CAAC,CAAC,EAAEF,MAAM,GAAGC,IAAI,CAAC;EAAA;EAE/D,IAAME,UAAU,GAAGJ,UAAU,CAACJ,KAAK,CAACjD,MAAM,EAAEI,KAAK,CAAC;EAClD,IAAMsD,SAAS,GAAGL,UAAU,CAACJ,KAAK,CAAChD,KAAK,EAAEI,IAAI,CAAC;EAC/C,IAAMsD,QAAQ,GAAGN,UAAU,CAACJ,KAAK,CAAC/C,IAAI,EAAEI,WAAW,CAAC;EAEpD,IAAMsD,aAAa,GAAGH,UAAU,GAAGC,SAAS,GAAGC,QAAQ;;EAEvD;EACA,IAAME,UAAU,GACd,0BAAAtB,MAAA,CAA0BU,KAAK,CAACjD,MAAM,eAAAuC,MAAA,CAAYU,KAAK,CAAChD,KAAK,cAAAsC,MAAA,CAAWU,KAAK,CAAC/C,IAAI,4BAAAqC,MAAA,CAChEnC,KAAK,cAAAmC,MAAA,CAAWlC,IAAI,sBAAAkC,MAAA,CAAmBjC,WAAW,OAAI,4BAAAiC,MAAA,CAC/CkB,UAAU,eAAAlB,MAAA,CAAYmB,SAAS,cAAAnB,MAAA,CAAWoB,QAAQ,OAAI,6BAAApB,MAAA,CACrDqB,aAAa,MAAG;EAE5C3B,OAAO,CAAChB,GAAG,CAAC4C,UAAU,CAAC;EAEvB,OAAO;IACLC,OAAO,EAAEb,KAAK;IACdc,KAAK,EAAE;MAAE3D,KAAK,EAALA,KAAK;MAAEC,IAAI,EAAJA,IAAI;MAAEC,WAAW,EAAXA;IAAY,CAAC;IACnC0D,IAAI,EAAE;MAAEhE,MAAM,EAAEyD,UAAU;MAAExD,KAAK,EAAEyD,SAAS;MAAExD,IAAI,EAAEyD;IAAS,CAAC;IAC9DC,aAAa,EAAbA;EACF,CAAC;AACH;AAEA,SAASK,KAAKA,CAACpC,KAAK,EAAE;EACpB,IAAIQ,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;EAC3BQ,QAAQ,CAACpB,GAAG,CAACkB,OAAO,CAClB,yBAAyB,GACvBE,QAAQ,CAACb,gBAAgB,CAACtD,MAAM,GAChC,cACJ,CAAC;EACDmE,QAAQ,CAACrB,KAAK,GAAG,OAAO,CAAC,CAAC;EAC1BwB,MAAM,CAACH,QAAQ,CAAC;EAChB,OAAOA,QAAQ;AACjB;AAEA,SAAS6B,OAAOA,CAACrC,KAAK,EAAE;EACtB,IAAIA,KAAK,CAACT,QAAQ,CAAClD,MAAM,IAAI,CAAC,EAAE;IAC9B+D,OAAO,CAAChB,GAAG,CAAC,6CAA6C,CAAC;IAC1D;EACF;EACA;EACA,IAAIoB,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;;EAE3B;EACA,IAAMsC,SAAS,GAAGvB,IAAI,CAACwB,GAAG,CAAC,CAAC,EAAE/B,QAAQ,CAACnB,QAAQ,CAAChD,MAAM,CAAC;EACvD,KAAK,IAAIuB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG0E,SAAS,EAAE1E,CAAC,EAAE,EAAE;IAClC,IAAMqC,IAAI,GAAAhD,aAAA,KAAQuD,QAAQ,CAACnB,QAAQ,CAACoB,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC;IAC/CD,QAAQ,CAACd,aAAa,CAAC3C,IAAI,CAACkD,IAAI,CAAC;EACnC;EAEAG,OAAO,CAAChB,GAAG,CAAC,iBAAiB,GAAGoB,QAAQ,CAACd,aAAa,CAAC,CAAC,CAAC,CAACxB,QAAQ,CAAC;;EAEnE;EACA,IAAIsC,QAAQ,CAACd,aAAa,CAAC,CAAC,CAAC,EAAE;IAC7Bc,QAAQ,CAACd,aAAa,CAAC,CAAC,CAAC,CAAC8C,QAAQ,GAAG,IAAI;EAC3C;;EAEA;EACAhC,QAAQ,GAAGiC,uBAAuB,CAACjC,QAAQ,CAAC;;EAE5C;EACAA,QAAQ,CAACrB,KAAK,GAAG,YAAY;;EAE7B;EACA,IAAI6C,UAAU,GAAG,iBAAiB;EAClCxB,QAAQ,CAACd,aAAa,CAACvC,OAAO,CAAC,UAACoE,IAAI,EAAEmB,KAAK,EAAK;IAC9C,IAAInB,IAAI,CAACiB,QAAQ,EAAE;MACjBR,UAAU,wBAAwB;IACpC,CAAC,MAAM;MACLA,UAAU,QAAAtB,MAAA,CAAQa,IAAI,CAACrD,QAAQ,OAAI;IACrC;EACF,CAAC,CAAC;EACFsC,QAAQ,CAACpB,GAAG,CAACkB,OAAO,CAAC0B,UAAU,CAAC;;EAEhC;;EAEArB,MAAM,CAACH,QAAQ,CAAC;AAClB;AAEA,SAASiC,uBAAuBA,CAACzC,KAAK,EAAE;EACtC,IAAIQ,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;EAC3BQ,QAAQ,CAACd,aAAa,CAACvC,OAAO,CAAC,UAACoE,IAAI,EAAK;IACvC,IAAI,CAACA,IAAI,CAACiB,QAAQ,EAAE;MAClBhC,QAAQ,GAAGmC,qBAAqB,CAACpB,IAAI,EAAEf,QAAQ,CAAC;IAClD;EACF,CAAC,CAAC;EACF,OAAOA,QAAQ;AACjB;AACA,SAASoC,kCAAkCA,CAAC5C,KAAK,EAAE;EACjD,IAAIQ,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;EAC3BQ,QAAQ,CAACjB,QAAQ,CAACpC,OAAO,CAAC,UAACoE,IAAI,EAAK;IAClC,IAAI,CAACA,IAAI,CAACiB,QAAQ,EAAE;MAClBhC,QAAQ,GAAGmC,qBAAqB,CAACpB,IAAI,EAAEf,QAAQ,CAAC;IAClD;EACF,CAAC,CAAC;EACF,OAAOA,QAAQ;AACjB;AACA,SAASmC,qBAAqBA,CAACpB,IAAI,EAAEvB,KAAK,EAAE;EAC1C,IAAIQ,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;EAE3B,IAAI,CAACuB,IAAI,CAACxC,kBAAkB,EAAE,OAAOyB,QAAQ;EAE7C,IACEe,IAAI,CAACvC,MAAM,KAAK,iCAAiC,IACjDwB,QAAQ,CAAChB,QAAQ,CAACnD,MAAM,GAAG,CAAC,EAC5B;IACA,IAAMwG,WAAW,GAAG,CAClB,OAAO,EACP,eAAe,EACf,YAAY,EACZ,aAAa,EACb,cAAc,EACd,cAAc,CACf;IACD,IAAMC,WAAW,GAAGtC,QAAQ,CAAChB,QAAQ,CAACuD,SAAS,CAAC,UAACC,IAAI;MAAA,OACnDH,WAAW,CAACI,QAAQ,CAACD,IAAI,CAAC1E,QAAQ,CAAC;IAAA,CACrC,CAAC;IAED,IAAI4E,aAAa;IACjB,IAAIJ,WAAW,KAAK,CAAC,CAAC,EAAE;MACtBI,aAAa,GAAG1C,QAAQ,CAAChB,QAAQ,CAACW,MAAM,CAAC2C,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7D,CAAC,MAAM;MACL,IAAMK,WAAW,GAAGpC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,GAAGT,QAAQ,CAAChB,QAAQ,CAACnD,MAAM,CAAC;MACxE6G,aAAa,GAAG1C,QAAQ,CAAChB,QAAQ,CAACW,MAAM,CAACgD,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7D;IAEA3C,QAAQ,CAAClB,WAAW,CAACvC,IAAI,CAACmG,aAAa,CAAC;IACxC1C,QAAQ,GAAG4C,oBAAoB,CAAC5C,QAAQ,EAAE0C,aAAa,EAAE3B,IAAI,CAACrD,QAAQ,CAAC;EACzE;EAEA,IAAIqD,IAAI,CAACvC,MAAM,KAAK,SAAS,EAAE;IAC7BwB,QAAQ,CAACX,cAAc,CAACC,EAAE,IAAIyB,IAAI,CAACtC,MAAM,IAAI,CAAC,CAAC,CAAC;IAChDuB,QAAQ,CAACpB,GAAG,CAACkB,OAAO,CAClB,OAAO,GAAGiB,IAAI,CAACtC,MAAM,GAAG,WAAW,GAAGsC,IAAI,CAACrD,QAAQ,GAAG,UACxD,CAAC;IACDsC,QAAQ,GAAG6C,UAAU,CAAC7C,QAAQ,CAAC;EACjC;EACA,IAAIe,IAAI,CAACvC,MAAM,KAAK,iBAAiB,EAAE;IACrC,IAAIsE,mBAAmB,GAAGvC,IAAI,CAACC,KAAK,CAACR,QAAQ,CAACb,gBAAgB,CAACtD,MAAM,GAAG,CAAC,CAAC;IAE1EiH,mBAAmB,GAAGvC,IAAI,CAACY,GAAG,CAAC2B,mBAAmB,GAAG,CAAC,EAAE,CAAC,CAAC;IAC1D9C,QAAQ,CAACX,cAAc,CAACC,EAAE,IAAIwD,mBAAmB;IACjD9C,QAAQ,CAACpB,GAAG,CAACkB,OAAO,CAClB,OAAO,GAAGgD,mBAAmB,GAAG,WAAW,GAAG/B,IAAI,CAACrD,QAAQ,GAAG,UAChE,CAAC;IACDsC,QAAQ,GAAG6C,UAAU,CAAC7C,QAAQ,CAAC;EACjC;EAEA,IAAIe,IAAI,CAACvC,MAAM,KAAK,mCAAmC,EAAE;IACvD,IAAMuE,QAAQ,GAAG/C,QAAQ,CAAChB,QAAQ,CAACgE,IAAI,CACrC,UAACR,IAAI;MAAA,OAAKA,IAAI,CAAC1E,QAAQ,KAAK,OAAO;IAAA,CACrC,CAAC;IACD,IAAMmF,QAAQ,GAAGjD,QAAQ,CAAChB,QAAQ,CAACgE,IAAI,CACrC,UAACR,IAAI;MAAA,OAAKA,IAAI,CAAC1E,QAAQ,KAAK,eAAe;IAAA,CAC7C,CAAC;IACD,IAAIiF,QAAQ,IAAIE,QAAQ,EAAE;MACxBjD,QAAQ,CAACpB,GAAG,CAACkB,OAAO,uCAAuC,CAAC;MAC5DiB,IAAI,CAACpD,MAAM,IAAI,EAAE;MACjBoD,IAAI,CAACnD,KAAK,IAAI,CAAC;IACjB;EACF;EAEA,IAAImD,IAAI,CAACvC,MAAM,KAAK,sCAAsC,EAAE;IAC1D,IAAM0E,WAAW,GAAGlD,QAAQ,CAAChB,QAAQ,CAAC5C,MAAM,CAAC,UAACoG,IAAI;MAAA,OAChD,CAAC,cAAc,EAAE,aAAa,EAAE,YAAY,CAAC,CAACC,QAAQ,CAACD,IAAI,CAAC1E,QAAQ,CAAC;IAAA,CACvE,CAAC;IACD,IAAIoF,WAAW,CAACrH,MAAM,GAAG,CAAC,EAAE;MAC1BqH,WAAW,CAACvG,OAAO,CAAC,UAAC6F,IAAI,EAAK;QAC5BxC,QAAQ,CAAChB,QAAQ,GAAGgB,QAAQ,CAAChB,QAAQ,CAAC5C,MAAM,CAAC,UAACgB,CAAC;UAAA,OAAKA,CAAC,KAAKoF,IAAI;QAAA,EAAC;QAC/DxC,QAAQ,CAAClB,WAAW,CAACvC,IAAI,CAACiG,IAAI,CAAC;QAC/BxC,QAAQ,CAACpB,GAAG,CAACkB,OAAO,2BAAAI,MAAA,CAA2BsC,IAAI,CAAC1E,QAAQ,MAAG,CAAC;QAChEkC,QAAQ,GAAG4C,oBAAoB,CAAC5C,QAAQ,EAAEwC,IAAI,EAAEzB,IAAI,CAACrD,QAAQ,CAAC;MAChE,CAAC,CAAC;IACJ,CAAC,MAAM;MACLsC,QAAQ,CAACpB,GAAG,CAACkB,OAAO,CAAC,6BAA6B,CAAC;IACrD;EACF;EAEA,OAAOE,QAAQ;AACjB;AAEA,SAAS6C,UAAUA,CAACrD,KAAK,EAAE;EACzB,IAAIQ,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;EAC3B,IAAIQ,QAAQ,CAACX,cAAc,CAACC,EAAE,IAAI,CAAC,EAAE;IACnC,OAAOsC,KAAK,CAAC5B,QAAQ,CAAC;EACxB;EACA,OAAOA,QAAQ;AACjB;;AAEA;AACA;AACA,SAASmD,kBAAkBA,CAAC3D,KAAK,EAAE0C,KAAK,EAAE;EACxC,IAAIlC,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;;EAE3B;EACA,IAAM4D,YAAY,GAAGpD,QAAQ,CAACd,aAAa,CAACS,MAAM,CAACuC,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EAC/DlC,QAAQ,CAACjB,QAAQ,CAACxC,IAAI,CAAC6G,YAAY,CAAC;;EAEpC;EACA,IAAIA,YAAY,CAACpB,QAAQ,EAAE;IACzBhC,QAAQ,CAACpB,GAAG,CAACkB,OAAO,sBAAsB,CAAC;EAC7C,CAAC,MAAM;IACLE,QAAQ,CAACpB,GAAG,CAACkB,OAAO,mBAAAI,MAAA,CAAmBkD,YAAY,CAAC1F,QAAQ,MAAG,CAAC;EAClE;;EAEA;EACA,IAAM2F,aAAa,GAAA1I,kBAAA,CAAOqF,QAAQ,CAACd,aAAa,CAAC;EACjDQ,OAAO,CAAC2D,aAAa,CAAC;EACtBA,aAAa,CAAC1G,OAAO,CAAC,UAAC8C,IAAI,EAAK;IAC9BA,IAAI,CAACuC,QAAQ,GAAG,KAAK;EACvB,CAAC,CAAC;EACFhC,QAAQ,CAACnB,QAAQ,GAAGmB,QAAQ,CAACnB,QAAQ,CAACqB,MAAM,CAACmD,aAAa,CAAC;;EAE3D;EACArD,QAAQ,CAACd,aAAa,GAAG,EAAE;;EAE3B;EACAc,QAAQ,CAACrB,KAAK,GAAG,SAAS;EAE1BwB,MAAM,CAACH,QAAQ,CAAC;AAClB;;AAEA;;AAEA,SAASsD,OAAOA,CAAC9D,KAAK,EAAE;EACtB,IAAIQ,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;;EAE3B;EACA,IAAIQ,QAAQ,CAACnB,QAAQ,CAAChD,MAAM,GAAG,CAAC,EAAE;IAChC,IAAM0H,UAAU,GAAA9G,aAAA,CAAAA,aAAA,KAAQuD,QAAQ,CAACnB,QAAQ,CAACoB,KAAK,CAAC,CAAC;MAAE+B,QAAQ,EAAE;IAAI,EAAE;IACnEhC,QAAQ,CAACjB,QAAQ,CAACxC,IAAI,CAACgH,UAAU,CAAC;EACpC;;EAEA;EACAvD,QAAQ,CAACjB,QAAQ,CAACpC,OAAO,CAAC,UAACoE,IAAI,EAAK;IAClC,IAAIA,IAAI,CAACiB,QAAQ,EAAE;MACjBjB,IAAI,CAACiB,QAAQ,GAAG,KAAK;IACvB;EACF,CAAC,CAAC;;EAEF;EACA,IAAMf,MAAM,GAAGN,sBAAsB,CAACX,QAAQ,EAAEA,QAAQ,CAACjB,QAAQ,CAAC;EAClE,IAAMyE,WAAW,GAAGvC,MAAM,CAACM,aAAa;;EAExC;EACAvB,QAAQ,CAACX,cAAc,CAACC,EAAE,IAAIkE,WAAW;;EAEzC;EACAxD,QAAQ,CAACpB,GAAG,CAACkB,OAAO,sBAAAI,MAAA,CACGF,QAAQ,CAACjB,QAAQ,CACnC0E,GAAG,CAAC,UAAC1C,IAAI;IAAA,OAAMA,IAAI,CAACiB,QAAQ,GAAG,KAAK,GAAGjB,IAAI,CAACrD,QAAQ;EAAA,CAAC,CAAC,CACtDgG,IAAI,CAAC,IAAI,CAAC,MACf,CAAC;EACD;EACA1D,QAAQ,CAACpB,GAAG,CAACkB,OAAO,0BAAAI,MAAA,CACOe,MAAM,CAACU,IAAI,CAAChE,MAAM,eAAAuC,MAAA,CAAYe,MAAM,CAACU,IAAI,CAAC/D,KAAK,cAAAsC,MAAA,CAAWe,MAAM,CAACU,IAAI,CAAC9D,IAAI,eAAAqC,MAAA,CAAYsD,WAAW,MAC5H,CAAC;;EAED;EACA,IAAIxD,QAAQ,CAACX,cAAc,CAACC,EAAE,IAAI,CAAC,EAAE;IACnCsC,KAAK,CAAC5B,QAAQ,CAAC;EACjB,CAAC,MAAM;IACL;IACA,IAAIA,QAAQ,CAACnB,QAAQ,CAAChD,MAAM,KAAK,CAAC,EAAE;MAClCmE,QAAQ,CAACrB,KAAK,GAAG,SAAS;MAC1BqB,QAAQ,CAACpB,GAAG,CAACkB,OAAO,mDAAAI,MAAA,CACgCF,QAAQ,CAACb,gBAAgB,CAACtD,MAAM,MACpF,CAAC;MACDsE,MAAM,CAACH,QAAQ,CAAC;MAChB;IACF;;IAEA;IACAA,QAAQ,CAACZ,SAAS,GAAG;MACnBrB,KAAK,EAAE,CAAC;MACRC,IAAI,EAAE,CAAC;MACPC,WAAW,EAAE;IACf,CAAC;IAED0F,IAAI,CAAC3D,QAAQ,CAAC;EAChB;AACF;;AAEA;;AAEA,SAAS2D,IAAIA,CAACnE,KAAK,EAAE;EACnB,IAAIQ,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;EAC3B;EACAQ,QAAQ,CAACrB,KAAK,GAAG,MAAM;EACvB;EACA,IAAIqB,QAAQ,CAACjB,QAAQ,CAAClD,MAAM,GAAG,CAAC,EAAE;IAChC,IAAM8G,WAAW,GAAGpC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,GAAGT,QAAQ,CAACjB,QAAQ,CAAClD,MAAM,CAAC;IACxE,IAAM+H,aAAa,GAAG5D,QAAQ,CAACjB,QAAQ,CAACY,MAAM,CAACgD,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;IACjE3C,QAAQ,CAAClB,WAAW,CAACvC,IAAI,CAACqH,aAAa,CAAC;IACxChE,OAAO,CAAChB,GAAG,oBAAAsB,MAAA,CAAoB0D,aAAa,CAAClG,QAAQ,CAAE,CAAC;EAC1D;EACA;EACAsC,QAAQ,CAACf,QAAQ,GAAGe,QAAQ,CAACf,QAAQ,CAACiB,MAAM,CAACF,QAAQ,CAACjB,QAAQ,CAAC;EAC/DiB,QAAQ,CAACjB,QAAQ,GAAG,EAAE;EACtBoB,MAAM,CAACH,QAAQ,CAAC;AAClB;;AAEA;AACA,SAAS6D,QAAQA,CAACrE,KAAK,EAAE0C,KAAK,EAAE;EAC9B,IAAIlC,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;EAC3B;EACA,IAAMsE,YAAY,GAAG9D,QAAQ,CAACf,QAAQ,CAACU,MAAM,CAACuC,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EAC1D,IAAI4B,YAAY,CAACxF,aAAa,EAAE;IAC9B0B,QAAQ,GAAG+D,sBAAsB,CAAC/D,QAAQ,EAAE8D,YAAY,CAAC;;IAEzD;IACA,IAAI9D,QAAQ,CAACrB,KAAK,KAAK,OAAO,EAAE;IAEhCiB,OAAO,CAAChB,GAAG,oBAAAsB,MAAA,CAAoB4D,YAAY,CAAChG,QAAQ,CAAE,CAAC;IACvD,OAAOiC,YAAY,CAACC,QAAQ,CAAC,CAAC,CAAC;EACjC;EACAA,QAAQ,CAAChB,QAAQ,CAACzC,IAAI,CAACuH,YAAY,CAAC;EACpC;EACA9D,QAAQ,CAACpB,GAAG,CAACkB,OAAO,oBAAAI,MAAA,CAAoB4D,YAAY,CAAChG,QAAQ,MAAG,CAAC;EACjE;EACAkC,QAAQ,CAAClB,WAAW,GAAGkB,QAAQ,CAAClB,WAAW,CAACoB,MAAM,CAACF,QAAQ,CAACf,QAAQ,CAAC;EACrEe,QAAQ,CAACf,QAAQ,GAAG,EAAE;;EAEtB;EACAe,QAAQ,GAAG+D,sBAAsB,CAAC/D,QAAQ,EAAE8D,YAAY,CAAC;EACzD9D,QAAQ,GAAG6C,UAAU,CAAC7C,QAAQ,CAAC;;EAE/B;EACA,IAAIA,QAAQ,CAACrB,KAAK,KAAK,OAAO,EAAE;EAEhCoB,YAAY,CAACC,QAAQ,CAAC;AACxB;;AAEA;AACA,SAAS+D,sBAAsBA,CAACvE,KAAK,EAAEgD,IAAI,EAAE;EAC3C,IAAIxC,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;EAC3B;EACA,IAAI,CAACgD,IAAI,CAACnE,UAAU,EAAE;IACpB,IAAImE,IAAI,CAACzE,KAAK,EAAE;MACdiC,QAAQ,CAACX,cAAc,CAACtB,KAAK,IAAIyE,IAAI,CAACzE,KAAK;IAC7C;IACA,IAAIyE,IAAI,CAACxE,IAAI,EAAE;MACbgC,QAAQ,CAACX,cAAc,CAACrB,IAAI,IAAIwE,IAAI,CAACxE,IAAI;IAC3C;IACA,IAAIwE,IAAI,CAACvE,WAAW,EAAE;MACpB+B,QAAQ,CAACX,cAAc,CAACpB,WAAW,IAAIuE,IAAI,CAACvE,WAAW;IACzD;EACF;EACA,IAAIuE,IAAI,CAACpE,KAAK,IAAIoE,IAAI,CAAClE,aAAa,EAAE;IACpC0B,QAAQ,CAACX,cAAc,CAACC,EAAE,IAAIkD,IAAI,CAACpE,KAAK;IACxC;IACA4B,QAAQ,CAACX,cAAc,CAACC,EAAE,GAAGiB,IAAI,CAACwB,GAAG,CAAC/B,QAAQ,CAACX,cAAc,CAACC,EAAE,EAAE,EAAE,CAAC;IACrE;IACAU,QAAQ,CAACpB,GAAG,CAACkB,OAAO,eAAAI,MAAA,CACJsC,IAAI,CAACpE,KAAK,oBAAA8B,MAAA,CAAiBF,QAAQ,CAACX,cAAc,CAACC,EAAE,CACrE,CAAC;IACDU,QAAQ,CAAClB,WAAW,CAACvC,IAAI,CAACiG,IAAI,CAAC,CAAC,CAAC;EACnC;EACA,IAAIA,IAAI,CAACrE,aAAa,EAAE;IACtB6B,QAAQ,CAACX,cAAc,CAACC,EAAE,IAAIkD,IAAI,CAACrE,aAAa;IAChD6B,QAAQ,CAACpB,GAAG,CAACkB,OAAO,QAAAI,MAAA,CACXsC,IAAI,CAAC1E,QAAQ,uBAAAoC,MAAA,CAAoBsC,IAAI,CAACrE,aAAa,SAC5D,CAAC;IACD6B,QAAQ,GAAG6C,UAAU,CAAC7C,QAAQ,CAAC;EACjC;EACAJ,OAAO,CAAChB,GAAG,CAAC,+BAA+B,GAAG4D,IAAI,CAAC1E,QAAQ,CAAC;EAC5DkC,QAAQ,GAAG6C,UAAU,CAAC7C,QAAQ,CAAC;EAE/B,OAAOA,QAAQ;AACjB;;AAEA;AACA,SAAS4C,oBAAoBA,CAACpD,KAAK,EAAEgD,IAAI,EAAE9E,QAAQ,EAAE;EACnD,IAAIsC,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;EAC3B;EACAI,OAAO,CAAChB,GAAG,CAAC,6BAA6B,GAAG4D,IAAI,CAAC1E,QAAQ,CAAC;EAC1D,IAAI,CAAC0E,IAAI,CAACnE,UAAU,EAAE;IACpB,IAAImE,IAAI,CAACzE,KAAK,EAAE;MACdiC,QAAQ,CAACX,cAAc,CAACtB,KAAK,IAAIyE,IAAI,CAACzE,KAAK;IAC7C;IACA,IAAIyE,IAAI,CAACxE,IAAI,EAAE;MACbgC,QAAQ,CAACX,cAAc,CAACrB,IAAI,IAAIwE,IAAI,CAACxE,IAAI;IAC3C;IACA,IAAIwE,IAAI,CAACvE,WAAW,EAAE;MACpB+B,QAAQ,CAACX,cAAc,CAACpB,WAAW,IAAIuE,IAAI,CAACvE,WAAW;IACzD;EACF;EACA;EACA+B,QAAQ,CAACpB,GAAG,CAACkB,OAAO,cAAAI,MAAA,CACLxC,QAAQ,oBAAAwC,MAAA,CAAiBsC,IAAI,CAAC1E,QAAQ,sBACrD,CAAC;EACD,OAAOkC,QAAQ;AACjB;AAEA,SAASgE,aAAaA,CAACxE,KAAK,EAAEyE,SAAS,EAAE;EACvC,IAAIjE,QAAQ,GAAAvD,aAAA,KAAQ+C,KAAK,CAAE;;EAE3B;EACA,IAAInB,UAAU,GAAG2B,QAAQ,CAAChB,QAAQ,CAACiF,SAAS,CAAC;EAC7C,IAAI,CAAC5F,UAAU,IAAI,CAACA,UAAU,CAACA,UAAU,EAAE,OAAO2B,QAAQ;;EAE1D;EACA,IAAI3B,UAAU,CAACN,KAAK,EAAE;IACpBiC,QAAQ,CAACZ,SAAS,CAACrB,KAAK,IAAIM,UAAU,CAACN,KAAK;EAC9C;EACA,IAAIM,UAAU,CAACL,IAAI,EAAE;IACnBgC,QAAQ,CAACZ,SAAS,CAACpB,IAAI,IAAIK,UAAU,CAACL,IAAI;EAC5C;EACA,IAAIK,UAAU,CAACJ,WAAW,EAAE;IAC1B+B,QAAQ,CAACZ,SAAS,CAACnB,WAAW,IAAII,UAAU,CAACJ,WAAW;EAC1D;EACA,IAAII,UAAU,CAACD,KAAK,EAAE;IACpB4B,QAAQ,CAACX,cAAc,CAACC,EAAE,IAAIjB,UAAU,CAACD,KAAK;IAC9C4B,QAAQ,CAACX,cAAc,CAACC,EAAE,GAAGiB,IAAI,CAACwB,GAAG,CAAC/B,QAAQ,CAACX,cAAc,CAACC,EAAE,EAAE,EAAE,CAAC;IACrEU,QAAQ,CAACpB,GAAG,CAACkB,OAAO,SAAAI,MAAA,CACV7B,UAAU,CAACP,QAAQ,mBAAAoC,MAAA,CAAgB7B,UAAU,CAACD,KAAK,kBAAA8B,MAAA,CAAeF,QAAQ,CAACX,cAAc,CAACC,EAAE,CACtG,CAAC;EACH,CAAC,MAAM;IACLU,QAAQ,CAACpB,GAAG,CAACkB,OAAO,SAAAI,MAAA,CAAS7B,UAAU,CAACP,QAAQ,MAAG,CAAC;EACtD;;EAEA;EACA,IAAMoG,OAAO,GAAGlE,QAAQ,CAAChB,QAAQ,CAACW,MAAM,CAACsE,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACzDjE,QAAQ,CAAClB,WAAW,CAACvC,IAAI,CAAC2H,OAAO,CAAC;EAElC/D,MAAM,CAACH,QAAQ,CAAC;EAChB,OAAOA,QAAQ;AACjB;;AAEA;;AAEA,SAASG,MAAMA,CAACX,KAAK,EAAE;EACrB,IAAM2E,MAAM,GAAGC,QAAQ,CAACC,cAAc,CAAC,QAAQ,CAAC;EAChDF,MAAM,CAACG,SAAS,GAAG,EAAE;;EAErB;EACA,IAAMC,SAAS,GAAGH,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;EAC/CD,SAAS,CAACE,SAAS,GAAG,aAAa;EAEnC,IAAMC,KAAK,GAAGN,QAAQ,CAACI,aAAa,CAAC,IAAI,CAAC;EAC1CE,KAAK,CAACC,WAAW,GAAG,eAAe;EAEnC,IAAMC,QAAQ,GAAGR,QAAQ,CAACI,aAAa,CAAC,GAAG,CAAC;EAC5CI,QAAQ,CAACN,SAAS,GAChB,4EAA4E;EAE9EC,SAAS,CAACM,WAAW,CAACH,KAAK,CAAC;EAC5BH,SAAS,CAACM,WAAW,CAACD,QAAQ,CAAC;EAC/BT,MAAM,CAACU,WAAW,CAACN,SAAS,CAAC;;EAE7B;EACA,IAAMO,QAAQ,GAAGV,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;EAC9CM,QAAQ,CAACL,SAAS,GAAG,YAAY;EACjCK,QAAQ,CAACH,WAAW,aAAAzE,MAAA,CAAaV,KAAK,CAACL,gBAAgB,CAACtD,MAAM,eAAAqE,MAAA,CAAYV,KAAK,CAACX,QAAQ,CAAChD,MAAM,kBAAAqE,MAAA,CAAeV,KAAK,CAACV,WAAW,CAACjD,MAAM,CAAE;EACxIsI,MAAM,CAACU,WAAW,CAACC,QAAQ,CAAC;;EAE5B;EACA,IAAMC,QAAQ,GAAGX,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;EAC9CO,QAAQ,CAACN,SAAS,GAAG,eAAe;EACpCM,QAAQ,CAACT,SAAS,iCAAApE,MAAA,CACOV,KAAK,CAACH,cAAc,CAACC,EAAE,sCAAAY,MAAA,CAE5CV,KAAK,CAACH,cAAc,CAACtB,KAAK,GAAGyB,KAAK,CAACJ,SAAS,CAACrB,KAAK,qCAAAmC,MAAA,CAE3BV,KAAK,CAACH,cAAc,CAACrB,IAAI,GAAGwB,KAAK,CAACJ,SAAS,CAACpB,IAAI,6CAAAkC,MAAA,CAEvEV,KAAK,CAACH,cAAc,CAACpB,WAAW,GAAGuB,KAAK,CAACJ,SAAS,CAACnB,WAAW,SAEjE;EACDkG,MAAM,CAACU,WAAW,CAACE,QAAQ,CAAC;;EAE5B;EACA,IAAMC,SAAS,GAAGxF,KAAK,CAACR,QAAQ,CAAC5C,MAAM,CAAC,UAACgB,CAAC;IAAA,OAAK,CAACA,CAAC,CAACiB,UAAU;EAAA,EAAC;EAC7D,IAAM4G,WAAW,GAAGzF,KAAK,CAACR,QAAQ,CAAC5C,MAAM,CAAC,UAACgB,CAAC;IAAA,OAAKA,CAAC,CAACiB,UAAU;EAAA,EAAC;EAE9D,IAAM6G,YAAY,GAAGd,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;EAClDU,YAAY,CAACT,SAAS,GAAG,iBAAiB;EAC1CS,YAAY,CAACZ,SAAS,oCAAoC;EAC1D,IAAIU,SAAS,CAACnJ,MAAM,KAAK,CAAC,EAAE;IAC1BqJ,YAAY,CAACZ,SAAS,IAAI,MAAM;EAClC,CAAC,MAAM;IACLU,SAAS,CAACrI,OAAO,CAAC,UAAC6F,IAAI,EAAK;MAC1B,IAAM2C,KAAK,GAAG,EAAE;MAChB,IAAI3C,IAAI,CAACzE,KAAK,EAAEoH,KAAK,CAAC5I,IAAI,WAAA2D,MAAA,CAAWsC,IAAI,CAACzE,KAAK,CAAE,CAAC;MAClD,IAAIyE,IAAI,CAACxE,IAAI,EAAEmH,KAAK,CAAC5I,IAAI,UAAA2D,MAAA,CAAUsC,IAAI,CAACxE,IAAI,CAAE,CAAC;MAC/C,IAAIwE,IAAI,CAACvE,WAAW,EAAEkH,KAAK,CAAC5I,IAAI,kBAAA2D,MAAA,CAAkBsC,IAAI,CAACvE,WAAW,CAAE,CAAC;MAErE,IAAMmH,IAAI,GACRD,KAAK,CAACtJ,MAAM,GAAG,CAAC,MAAAqE,MAAA,CACTsC,IAAI,CAAC1E,QAAQ,QAAAoC,MAAA,CAAKiF,KAAK,CAACzB,IAAI,CAAC,IAAI,CAAC,YAAAxD,MAAA,CAClCsC,IAAI,CAAC1E,QAAQ,CAAE;MAExBoH,YAAY,CAACZ,SAAS,IAAIc,IAAI,GAAG,MAAM;IACzC,CAAC,CAAC;EACJ;EACAjB,MAAM,CAACU,WAAW,CAACK,YAAY,CAAC;EAEhC,IAAMG,cAAc,GAAGjB,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;EACpDa,cAAc,CAACZ,SAAS,GAAG,mBAAmB;EAC9CY,cAAc,CAACf,SAAS,mCAAmC;EAC3D,IAAIW,WAAW,CAACpJ,MAAM,KAAK,CAAC,EAAE;IAC5BwJ,cAAc,CAACf,SAAS,IAAI,MAAM;EACpC,CAAC,MAAM;IACLW,WAAW,CAACtI,OAAO,CAAC,UAAC6F,IAAI,EAAK;MAC5B,IAAM8C,GAAG,GAAGlB,QAAQ,CAACI,aAAa,CAAC,QAAQ,CAAC;MAC5Cc,GAAG,CAACb,SAAS,GAAG,mBAAmB;MACnCa,GAAG,CAACX,WAAW,MAAAzE,MAAA,CAAMsC,IAAI,CAAC1E,QAAQ,CAAE;MACpCwH,GAAG,CAACC,OAAO,GAAG;QAAA,OAAMvB,aAAa,CAACxE,KAAK,EAAEA,KAAK,CAACR,QAAQ,CAACwG,OAAO,CAAChD,IAAI,CAAC,CAAC;MAAA;MACtE6C,cAAc,CAACR,WAAW,CAACS,GAAG,CAAC;IACjC,CAAC,CAAC;EACJ;EACAnB,MAAM,CAACU,WAAW,CAACQ,cAAc,CAAC;;EAElC;EACA,IAAMI,QAAQ,GAAGrB,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;EAC9CiB,QAAQ,CAAChB,SAAS,GAAG,eAAe;EACpCgB,QAAQ,CAACnB,SAAS,GAAG,4CAA4C;EAEjE,IAAMoB,UAAU,GAAGtB,QAAQ,CAACI,aAAa,CAAC,OAAO,CAAC;EAClDkB,UAAU,CAACjB,SAAS,GAAG,aAAa;EACpCjF,KAAK,CAACT,QAAQ,CAACpC,OAAO,CAAC,UAACoE,IAAI,EAAK;IAC/B,IAAM4E,GAAG,GAAGvB,QAAQ,CAACI,aAAa,CAAC,IAAI,CAAC;IACxCmB,GAAG,CAAClB,SAAS,GAAG1D,IAAI,CAACiB,QAAQ,GAAG,gBAAgB,GAAG,cAAc;IAEjE,IAAIjB,IAAI,CAACiB,QAAQ,EAAE;MACjB2D,GAAG,CAACrB,SAAS,mLAKhB;IACC,CAAC,MAAM;MACLqB,GAAG,CAACrB,SAAS,oCAAApE,MAAA,CACSa,IAAI,CAACrD,QAAQ,yCAAAwC,MAAA,CACba,IAAI,CAACpD,MAAM,KAAK,CAAC,WAAAuC,MAAA,CAAWa,IAAI,CAACpD,MAAM,IAAK,EAAE,yCAAAuC,MAAA,CAC9Ca,IAAI,CAACnD,KAAK,KAAK,CAAC,WAAAsC,MAAA,CAAWa,IAAI,CAACnD,KAAK,IAAK,EAAE,yCAAAsC,MAAA,CAC5Ca,IAAI,CAAClD,IAAI,KAAK,CAAC,WAAAqC,MAAA,CAAWa,IAAI,CAAClD,IAAI,IAAK,EAAE,cACnE;IACC;IACA6H,UAAU,CAACb,WAAW,CAACc,GAAG,CAAC;EAC7B,CAAC,CAAC;EACFF,QAAQ,CAACZ,WAAW,CAACa,UAAU,CAAC;EAChCvB,MAAM,CAACU,WAAW,CAACY,QAAQ,CAAC;;EAE5B;EACA,IAAIjG,KAAK,CAACb,KAAK,KAAK,YAAY,EAAE;IAChC,IAAMiH,YAAY,GAAGxB,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;IAClDoB,YAAY,CAACnB,SAAS,GAAG,gBAAgB;IACzCmB,YAAY,CAACtB,SAAS,GAAG,qCAAqC;IAC9D9E,KAAK,CAACN,aAAa,CAACvC,OAAO,CAAC,UAAC8C,IAAI,EAAEyC,KAAK,EAAK;MAC3C,IAAM2D,OAAO,GAAGzB,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;MAC7CqB,OAAO,CAACpB,SAAS,GAAG,WAAW;MAE/B,IAAIhF,IAAI,CAACuC,QAAQ,EAAE;QACjB6D,OAAO,CAAClB,WAAW,GAAG,iBAAiB;MACzC,CAAC,MAAM;QACL,IAAMmB,KAAK,GAAG,YAAA5F,MAAA,CAAYT,IAAI,CAAC/B,QAAQ,eAAY;QACnD,IAAI+B,IAAI,CAAC9B,MAAM,KAAK,CAAC,EAAEmI,KAAK,CAACvJ,IAAI,YAAA2D,MAAA,CAAYT,IAAI,CAAC9B,MAAM,CAAE,CAAC;QAC3D,IAAI8B,IAAI,CAAC7B,KAAK,KAAK,CAAC,EAAEkI,KAAK,CAACvJ,IAAI,WAAA2D,MAAA,CAAWT,IAAI,CAAC7B,KAAK,CAAE,CAAC;QACxD,IAAI6B,IAAI,CAAC5B,IAAI,KAAK,CAAC,EAAEiI,KAAK,CAACvJ,IAAI,UAAA2D,MAAA,CAAUT,IAAI,CAAC5B,IAAI,CAAE,CAAC;QACrDgI,OAAO,CAACvB,SAAS,GAAGwB,KAAK,CAACpC,IAAI,CAAC,MAAM,CAAC;MACxC;MAEAmC,OAAO,CAACN,OAAO,GAAG;QAAA,OAAMpC,kBAAkB,CAAC3D,KAAK,EAAE0C,KAAK,CAAC;MAAA;MACxD0D,YAAY,CAACf,WAAW,CAACgB,OAAO,CAAC;IACnC,CAAC,CAAC;IACF1B,MAAM,CAACU,WAAW,CAACe,YAAY,CAAC;EAClC;;EAEA;EACA,IAAIpG,KAAK,CAACb,KAAK,KAAK,MAAM,EAAE;IAC1B,IAAMoH,OAAO,GAAG3B,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;IAC7CuB,OAAO,CAACtB,SAAS,GAAG,cAAc;IAClCsB,OAAO,CAACzB,SAAS,GAAG,+CAA+C;IAEnE9E,KAAK,CAACP,QAAQ,CAAC1D,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAACoB,OAAO,CAAC,UAAC6F,IAAI,EAAEN,KAAK,EAAK;MAClD,IAAM8D,OAAO,GAAG5B,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;MAC7CwB,OAAO,CAACvB,SAAS,GAAG,WAAW;MAE/B,IAAIqB,KAAK,GAAG,YAAA5F,MAAA,CAAYsC,IAAI,CAAC1E,QAAQ,eAAY;MACjD,IAAI0E,IAAI,CAACzE,KAAK,EAAE+H,KAAK,CAACvJ,IAAI,WAAA2D,MAAA,CAAWsC,IAAI,CAACzE,KAAK,CAAE,CAAC;MAClD,IAAIyE,IAAI,CAACxE,IAAI,EAAE8H,KAAK,CAACvJ,IAAI,UAAA2D,MAAA,CAAUsC,IAAI,CAACxE,IAAI,CAAE,CAAC;MAC/C,IAAIwE,IAAI,CAACvE,WAAW,EAAE6H,KAAK,CAACvJ,IAAI,kBAAA2D,MAAA,CAAkBsC,IAAI,CAACvE,WAAW,CAAE,CAAC;MACrE,IAAIuE,IAAI,CAACpE,KAAK,EAAE0H,KAAK,CAACvJ,IAAI,WAAA2D,MAAA,CAAWsC,IAAI,CAACpE,KAAK,CAAE,CAAC;MAClD,IAAIoE,IAAI,CAACnE,UAAU,EAAEyH,KAAK,CAACvJ,IAAI,sBAAsB,CAAC;MAEtDyJ,OAAO,CAAC1B,SAAS,GAAGwB,KAAK,CAACpC,IAAI,CAAC,MAAM,CAAC;MACtCsC,OAAO,CAACT,OAAO,GAAG;QAAA,OAAM1B,QAAQ,CAACrE,KAAK,EAAE0C,KAAK,CAAC;MAAA;MAC9C6D,OAAO,CAAClB,WAAW,CAACmB,OAAO,CAAC;IAC9B,CAAC,CAAC;IACF7B,MAAM,CAACU,WAAW,CAACkB,OAAO,CAAC;EAC7B;;EAEA;EACA,IAAME,SAAS,GAAG7B,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;EAC/CyB,SAAS,CAACxB,SAAS,GAAG,gBAAgB;EAEtC,IAAMyB,UAAU,GAAG9B,QAAQ,CAACI,aAAa,CAAC,QAAQ,CAAC;EACnD0B,UAAU,CAACzB,SAAS,GAAG,gBAAgB;EACvCyB,UAAU,CAACvB,WAAW,GAAG,SAAS;EAClCuB,UAAU,CAACC,QAAQ,GACjB3G,KAAK,CAACb,KAAK,KAAK,SAAS,IACzBa,KAAK,CAACT,QAAQ,CAAClD,MAAM,IAAI,CAAC,IAC1B2D,KAAK,CAACX,QAAQ,CAAChD,MAAM,KAAK,CAAC;EAC7BqK,UAAU,CAACX,OAAO,GAAG;IAAA,OAAM1D,OAAO,CAACrC,KAAK,CAAC;EAAA;EACzCyG,SAAS,CAACpB,WAAW,CAACqB,UAAU,CAAC;EAEjC,IAAME,UAAU,GAAGhC,QAAQ,CAACI,aAAa,CAAC,QAAQ,CAAC;EACnD4B,UAAU,CAAC3B,SAAS,GAAG,gBAAgB;EACvC2B,UAAU,CAACzB,WAAW,GAAG,SAAS;EAClCyB,UAAU,CAACD,QAAQ,GACjB3G,KAAK,CAACb,KAAK,KAAK,SAAS,IAAIa,KAAK,CAACT,QAAQ,CAAClD,MAAM,KAAK,CAAC;EAC1DuK,UAAU,CAACb,OAAO,GAAG;IAAA,OAAMjC,OAAO,CAAC9D,KAAK,CAAC;EAAA;EACzCyG,SAAS,CAACpB,WAAW,CAACuB,UAAU,CAAC;EAEjCjC,MAAM,CAACU,WAAW,CAACoB,SAAS,CAAC;;EAE7B;EACA,IAAMI,MAAM,GAAGjC,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;EAC5C6B,MAAM,CAAC5B,SAAS,GAAG,eAAe;EAClC4B,MAAM,CAAC/B,SAAS,GAAG,4BAA4B;EAC/C,IAAMgC,WAAW,GAAG9G,KAAK,CAACZ,GAAG,CAACrD,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC;EAC1C+K,WAAW,CAAC3J,OAAO,CAAC,UAAC4J,GAAG,EAAErE,KAAK,EAAK;IAClC,IAAMsE,QAAQ,GAAGpC,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;IAC9CgC,QAAQ,CAAC/B,SAAS,GAAG,WAAW;IAChC,IAAIvC,KAAK,KAAK,CAAC,EAAE;MACfsE,QAAQ,CAACC,SAAS,CAACC,GAAG,CAAC,eAAe,CAAC;IACzC;IACAF,QAAQ,CAACG,KAAK,CAACC,OAAO,GAAGrG,IAAI,CAACY,GAAG,CAAC,CAAC,GAAGe,KAAK,GAAG,GAAG,EAAE,GAAG,CAAC;IACvDsE,QAAQ,CAAC7B,WAAW,GAAG4B,GAAG;IAC1BF,MAAM,CAACxB,WAAW,CAAC2B,QAAQ,CAAC;EAC9B,CAAC,CAAC;EACFrC,MAAM,CAACU,WAAW,CAACwB,MAAM,CAAC;;EAE1B;EACA;EACA,IAAMQ,UAAU,GAAGzC,QAAQ,CAACI,aAAa,CAAC,KAAK,CAAC;EAChDqC,UAAU,CAACpC,SAAS,GAAG,oBAAoB;EAC3CN,MAAM,CAACU,WAAW,CAACgC,UAAU,CAAC;EAC9B,IAAMC,UAAU,GAAG1C,QAAQ,CAACI,aAAa,CAAC,QAAQ,CAAC;EACnDsC,UAAU,CAACrC,SAAS,GAAG,iBAAiB;EACxCqC,UAAU,CAACnC,WAAW,GAAG,UAAU;EACnCmC,UAAU,CAACvB,OAAO,GAAGhG,OAAO;EAC5B4E,MAAM,CAACU,WAAW,CAACiC,UAAU,CAAC;;EAE9B;EACA,IAAItH,KAAK,CAACb,KAAK,KAAK,OAAO,EAAE;IAC3ByF,QAAQ,CAAC2C,gBAAgB,CAAC,8BAA8B,CAAC,CAACpK,OAAO,CAAC,UAAC2I,GAAG,EAAK;MACzEA,GAAG,CAACa,QAAQ,GAAG,IAAI;IACrB,CAAC,CAAC;EACJ;EACA,IAAI3G,KAAK,CAACb,KAAK,KAAK,OAAO,EAAE;IAC3ByF,QAAQ,CAAC2C,gBAAgB,CAAC,YAAY,CAAC,CAACpK,OAAO,CAAC,UAACqK,KAAK,EAAK;MACzDA,KAAK,CAACP,SAAS,CAACC,GAAG,CAAC,WAAW,CAAC;IAClC,CAAC,CAAC;EACJ;EACA,IAAIlH,KAAK,CAACb,KAAK,KAAK,OAAO,EAAE;IAC3ByF,QAAQ,CACL2C,gBAAgB,CAAC,mCAAmC,CAAC,CACrDpK,OAAO,CAAC,UAACsK,EAAE,EAAK;MACfA,EAAE,CAACN,KAAK,CAACC,OAAO,GAAG,KAAK;IAC1B,CAAC,CAAC;EACN;;EAEA;EACA,IAAIpH,KAAK,CAACb,KAAK,KAAK,SAAS,EAAE;IAC7ByF,QAAQ,CAAC2C,gBAAgB,CAAC,8BAA8B,CAAC,CAACpK,OAAO,CAAC,UAAC2I,GAAG,EAAK;MACzEA,GAAG,CAACa,QAAQ,GAAG,IAAI;IACrB,CAAC,CAAC;IACF/B,QAAQ,CAAC2C,gBAAgB,CAAC,YAAY,CAAC,CAACpK,OAAO,CAAC,UAACqK,KAAK,EAAK;MACzDA,KAAK,CAACL,KAAK,CAACO,KAAK,GAAG,OAAO,CAAC,CAAC;IAC/B,CAAC,CAAC;IACF9C,QAAQ,CACL2C,gBAAgB,CAAC,mCAAmC,CAAC,CACrDpK,OAAO,CAAC,UAACsK,EAAE,EAAK;MACfA,EAAE,CAACN,KAAK,CAACC,OAAO,GAAG,KAAK;IAC1B,CAAC,CAAC;EACN;AACF;AAEAO,MAAM,CAACC,MAAM,GAAG,YAAM;EACpB7H,OAAO,CAAC,CAAC;AACX,CAAC","file":"main.1f19ae8e.js","sourceRoot":"../src","sourcesContent":["\"use strict\";\n\nconst cardList = [\n  //easiest rooms\n  {\n    roomName: \"Shatterglass Trap\",\n    attack: 0,\n    curse: 0,\n    trap: 2,\n    itemName: \"Monocle\",\n    armor: 0,\n    ward: 0,\n    detectTraps: 1,\n    copies: 3,\n  },\n  {\n    roomName: \"Cracked Flagstones\",\n    attack: 0,\n    curse: 2,\n    trap: 0,\n    itemName: \"Cracked Amulet\",\n    armor: 1,\n    ward: 0,\n    detectTraps: 0,\n    copies: 3,\n  },\n  {\n    roomName: \"Goblin Warren\",\n    attack: 2,\n    curse: 0,\n    trap: 0,\n    itemName: \"Lucky Coin\",\n    armor: 0,\n    ward: 1,\n    detectTraps: 0,\n    copies: 3,\n  },\n  {\n    roomName: \"Dust Weevil Burrow\",\n    attack: 1,\n    curse: 0,\n    trap: 0,\n    itemName: \"Ashes\",\n    armor: 0,\n    ward: 0,\n    detectTraps: 0,\n    copies: 6,\n  },\n  //basic rooms\n  {\n    roomName: \"Spike Pit\",\n    attack: 0,\n    curse: 0,\n    trap: 3,\n    itemName: \"Trapdoor Shield\",\n    armor: 2,\n    ward: 0,\n    detectTraps: 0,\n    copies: 3,\n  },\n  {\n    roomName: \"Malevolent Mirror-hall\",\n    attack: 0,\n    curse: 3,\n    trap: 0,\n    itemName: \"Mirror Shard\",\n    armor: 0,\n    ward: 2,\n    detectTraps: 0,\n    copies: 3,\n  },\n  {\n    roomName: \"Bandit Ambush\",\n    attack: 3,\n    curse: 0,\n    trap: 0,\n    itemName: \"Burglar's Tools\",\n    armor: 0,\n    ward: 0,\n    detectTraps: 2,\n    copies: 3,\n  },\n  //medium rooms\n  {\n    roomName: \"Guillotine Gauntlet\",\n    attack: 0,\n    curse: 0,\n    trap: 6,\n    itemName: \"Scimitar\",\n    armor: 3,\n    ward: 0,\n    detectTraps: 0,\n    copies: 3,\n  },\n  {\n    roomName: \"Arcane Labyrinth\",\n    attack: 0,\n    curse: 6,\n    trap: 0,\n    itemName: \"Lodestone\",\n    armor: 0,\n    ward: 3,\n    detectTraps: 0,\n    copies: 3,\n  },\n  {\n    roomName: \"Orc Camp\",\n    attack: 6,\n    curse: 0,\n    trap: 0,\n    itemName: \"Dousing Rod\",\n    armor: 0,\n    ward: 0,\n    detectTraps: 3,\n    copies: 3,\n  },\n  //hard rooms\n  {\n    roomName: \"Poisoned Pit\",\n    attack: 0,\n    curse: 4,\n    trap: 4,\n    itemName: \"Poisoned Dagger\",\n    armor: 3,\n    ward: -1,\n    detectTraps: 0,\n    copies: 2,\n  },\n  {\n    roomName: \"Undead Catacombs\",\n    attack: 4,\n    curse: 4,\n    trap: 0,\n    itemName: \"Cursed Blade\",\n    armor: +4,\n    ward: -2,\n    detectTraps: 0,\n    copies: 2,\n  },\n  //extreme rooms\n  {\n    roomName: \"Razorwire Maze\",\n    attack: 0,\n    curse: 2,\n    trap: 8,\n    itemName: \"Crown of Razors\",\n    armor: 3,\n    ward: 1,\n    detectTraps: 1,\n    copies: 1,\n    injuresOnLoot: 3, // injures player on loot\n  },\n  {\n    roomName: \"Chamber of Mists\",\n    attack: 2,\n    curse: 4,\n    trap: 4,\n    itemName: \"Mist Shroud\",\n    armor: 1,\n    ward: 2,\n    detectTraps: 1,\n    copies: 1,\n  },\n  {\n    roomName: \"Giant Spider Lair\",\n    attack: 5,\n    curse: 0,\n    trap: 5,\n    itemName: \"Spidersilk Cloak\",\n    armor: 2,\n    ward: 0,\n    detectTraps: 2,\n    copies: 1,\n  },\n  {\n    roomName: \"Dragon's Den\",\n    attack: 5,\n    curse: 5,\n    trap: 5,\n    itemName: \"Dragon's Gold\",\n    armor: 0,\n    ward: 0,\n    detectTraps: 0,\n    copies: 1,\n  },\n  //potion rooms\n  {\n    roomName: \"Hall of Brine\",\n    attack: 0,\n    curse: 1,\n    trap: 0,\n    itemName: \"Lesser Healing Potion\",\n    armor: 0,\n    ward: 0,\n    detectTraps: 0,\n    heals: 5,\n    consumable: true,\n    copies: 3,\n  },\n  {\n    roomName: \"Hall of Alchemy\",\n    attack: 1,\n    curse: 1,\n    trap: 1,\n    itemName: \"Healing Potion\",\n    armor: 0,\n    ward: 0,\n    detectTraps: 0,\n    heals: 10,\n    consumable: true,\n    copies: 5,\n  },\n  {\n    roomName: \"Hall of Shattered Glass\",\n    attack: 0,\n    curse: 0,\n    trap: 1,\n    itemName: \"Lesser Rainbow Potion\",\n    armor: 1,\n    ward: 1,\n    detectTraps: 1,\n    consumable: true,\n    copies: 1,\n  },\n  {\n    roomName: \"Hall of Prisms\",\n    attack: 1,\n    curse: 2,\n    trap: 2,\n    itemName: \"Rainbow Potion\",\n    armor: 3,\n    ward: 3,\n    detectTraps: 3,\n    heals: 5,\n    consumable: true,\n    copies: 3,\n  },\n  {\n    roomName: \"Hall of Arcane Snares\",\n    attack: 0,\n    curse: 2,\n    trap: 2,\n    itemName: \"Magic Immunity Potion\",\n    armor: 0,\n    ward: 100,\n    detectTraps: 0,\n    consumable: true,\n    copies: 2,\n  },\n\n  {\n    roomName: \"Hall of the Medusa\",\n    attack: 2,\n    curse: 2,\n    trap: 0,\n    itemName: \"Stoneskin Potion\",\n    armor: 100,\n    ward: 0,\n    detectTraps: 0,\n    consumable: true,\n    copies: 2,\n  },\n  {\n    roomName: \"Hall of Assassins\",\n    attack: 2,\n    curse: 0,\n    trap: 2,\n    itemName: \"Spidersense Potion\",\n    armor: 0,\n    ward: 0,\n    detectTraps: 100,\n    consumable: true,\n    copies: 2,\n  },\n  // blessed rooms\n  {\n    roomName: \"Blessed Chamber of the Amulet\",\n    attack: 0,\n    curse: 0,\n    trap: 0,\n    itemName: \"Nazar Amulet\",\n    armor: 0,\n    ward: 3,\n    detectTraps: 0,\n    copies: 1,\n  },\n  {\n    roomName: \"Blessed Chamber of the Aegis\",\n    attack: 0,\n    curse: 0,\n    trap: 0,\n    itemName: \"Aegis Shield\",\n    armor: 3,\n    ward: 0,\n    detectTraps: 0,\n    copies: 1,\n  },\n  {\n    roomName: \"Blessed Chamber of the Ring\",\n    attack: 0,\n    curse: 0,\n    trap: 0,\n    itemName: \"Ring of Truesight\",\n    armor: 0,\n    ward: 0,\n    detectTraps: 3,\n    copies: 1,\n  },\n  {\n    roomName: \"Blessed Healing Fountain\",\n    attack: 0,\n    curse: 0,\n    trap: 0,\n    itemName: \"Fountain Blessing\",\n    armor: 0,\n    ward: 0,\n    detectTraps: 0,\n    heals: 20, // amount healed\n    autoUseOnLoot: true,\n    copies: 7,\n  },\n  //harmful rooms\n  {\n    roomName: \"Vile Barbed Tunnel\",\n    attack: 2,\n    curse: 0,\n    trap: 1,\n    itemName: \"Scarring Barb\",\n    armor: -1,\n    curse: 0,\n    detectTraps: 0,\n    copies: 2,\n  },\n  {\n    roomName: \"Vile Traumatizing Fog\",\n    attack: 0,\n    curse: 3,\n    trap: 0,\n    itemName: \"Mental Trauma\",\n    armor: 0,\n    curse: -1,\n    detectTraps: 0,\n    copies: 2,\n  },\n  {\n    roomName: \"Vile Intoxicating Still\",\n    attack: 0,\n    curse: 1,\n    trap: 2,\n    itemName: \"Disorientating Brew\",\n    armor: 0,\n    curse: 0,\n    detectTraps: -1,\n    copies: 2,\n  },\n  {\n    roomName: \"Vile Torture Chamber\",\n    attack: 2,\n    curse: 2,\n    trap: 2,\n    itemName: \"Horrific Injuries\",\n    armor: -1,\n    curse: -1,\n    detectTraps: -1,\n    copies: 1,\n  },\n  //cursed rooms\n  {\n    roomName: \"Cursed Oubliette\",\n    attack: 0,\n    curse: 0,\n    trap: 0,\n    effectOnRoomReveal: true,\n    effect: \"discard a random item from belt\",\n    itemName: \"Ashes\",\n    armor: 0,\n    ward: 0,\n    detectTraps: 0,\n    copies: 5,\n  },\n  {\n    roomName: \"Cursed Rust Portal\",\n    attack: 0,\n    curse: 2,\n    trap: 2,\n    effectOnRoomReveal: true,\n    effect: \"discard a random item from belt\",\n    itemName: \"Rust\",\n    armor: -1,\n    ward: 0,\n    detectTraps: 0,\n    copies: 1,\n  },\n  {\n    roomName: \"Cursed Fire Pit\",\n    attack: 0,\n    curse: 2,\n    trap: 3,\n    itemName: \"Burning Coals\",\n    injuresOnLoot: 3, // injures player on loot\n    armor: 1,\n    ward: 1,\n    detectTraps: 1,\n    copies: 2,\n  },\n  {\n    roomName: \"Cursed Bestiary\",\n    attack: 3,\n    curse: 0,\n    trap: 0,\n    itemName: \"Cursed Paw\",\n    armor: -1,\n    ward: +1,\n    detectTraps: 0,\n    copies: 2,\n  },\n  {\n    roomName: \"Cursed Statuary\",\n    attack: 0,\n    curse: 3,\n    trap: 0,\n    itemName: \"Cursed Idol\",\n    armor: 0,\n    ward: -1,\n    detectTraps: +1,\n    copies: 2,\n  },\n  {\n    roomName: \"Cursed Herbary\",\n    attack: 0,\n    curse: 0,\n    trap: 3,\n    itemName: \"Cursed Thorn\",\n    armor: +1,\n    ward: 0,\n    detectTraps: -1,\n    copies: 2,\n  },\n  //detonating rooms\n  {\n    roomName: \"Sudden Fireball Trap\",\n    attack: 0,\n    curse: 1,\n    trap: 1,\n    effectOnRoomReveal: true,\n    effect: \"lose HP\",\n    hpLoss: 3,\n    itemName: \"Ashes\",\n    armor: 0,\n    ward: 0,\n    detectTraps: 0,\n    copies: 3,\n  },\n  {\n    roomName: \"Sudden Death Fog Trap\",\n    attack: 0,\n    curse: 2,\n    trap: 2,\n    effectOnRoomReveal: true,\n    effect: \"lose HP\",\n    hpLoss: 5,\n    itemName: \"Gasmask\",\n    armor: 1,\n    ward: 0,\n    detectTraps: 1,\n    copies: 1,\n  },\n  {\n    roomName: \"Sudden Crumbling Staircase\",\n    attack: 2,\n    curse: 2,\n    trap: 2,\n    effectOnRoomReveal: true,\n    effect: \"lose special HP\",\n    itemName: \"brick\",\n    armor: 1,\n    ward: 0,\n    detectTraps: 0,\n    copies: 1,\n  },\n  //special rooms\n  {\n    roomName: \"Golem Forge\",\n    attack: 10,\n    curse: 5,\n    trap: 0,\n    effectOnRoomReveal: true,\n    effect: \"nerf if player has ashes or coals\",\n    itemName: \"Golem Armor\",\n    armor: 5,\n    ward: 2,\n    detectTraps: 0,\n    copies: 1,\n  },\n  {\n    roomName: \"Forbidden Bazaar\",\n    attack: 1,\n    curse: 1,\n    trap: 1,\n    effectOnRoomReveal: true,\n    effect: \"discard all of player's cursed items\",\n    itemName: \"Forbidden Tome\",\n    armor: 1,\n    ward: 1,\n    detectTraps: 1,\n    copies: 1,\n  },\n  {\n    roomName: \"Demonic Circle\",\n    attack: 6,\n    curse: 6,\n    trap: 6,\n    itemName: \"Demonic Rune\",\n    armor: -6,\n    ward: -6,\n    detectTraps: -6,\n    copies: 1,\n  },\n  {\n    roomName: \"Blessed Chapel of Angels\",\n    attack: 0,\n    curse: 0,\n    trap: 0,\n    itemName: \"Blessed Halo\",\n    armor: 1,\n    ward: 3,\n    detectTraps: 1,\n    copies: 1,\n  },\n  {\n    roomName: \"Iron Golem Foundry\",\n    attack: 4,\n    curse: 4,\n    trap: 4,\n    itemName: \"Iron Golem Helm\",\n    armor: 2,\n    ward: 2,\n    detectTraps: 2,\n    copies: 1,\n  },\n];\n\nfunction createInitialState() {\n  return {\n    phase: \"explore\",\n    log: [],\n\n    deckPile: [],\n    discardPile: [],\n    roomPile: [],\n    itemPile: [],\n    lootPile: [],\n    selectionPile: [],\n    levelTrackerPile: [],\n\n    tempBuffs: {\n      armor: 0,\n      ward: 0,\n      detectTraps: 0,\n    },\n    characterSheet: {\n      hp: 30,\n      armor: 0,\n      ward: 0,\n      detectTraps: 0,\n    },\n\n    cardList: cardList,\n  };\n}\n\nfunction newGame() {\n  const state = createInitialState();\n\n  // Populate deck\n  state.cardList.forEach((card) => {\n    for (let i = 0; i < card.copies; i++) {\n      state.deckPile.push({ ...card });\n    }\n  });\n\n  //prep game\n  shuffle(state.deckPile);\n  state.discardPile = state.deckPile.splice(0, 10); // burn 10 - on paper, used to track HP.\n\n  console.log(\"New game started. countCards:\", countCards(state), state);\n  //log game start\n  state.log.unshift(\"New donjon run started.\");\n  advanceLevel(state);\n}\n\nfunction advanceLevel(state) {\n  let newState = { ...state };\n\n  // Draw the next level card (if available)\n  if (newState.deckPile.length > 0) {\n    let card = newState.deckPile.shift();\n    newState.levelTrackerPile.push(card);\n    console.log(\"Advanced to level \" + newState.levelTrackerPile.length);\n  }\n\n  // Victory check: if the deck is now empty\n  if (newState.deckPile.length === 0) {\n    newState.phase = \"victory\";\n    newState.log.unshift(\n      `You have survived the donjon! Victory at level ${newState.levelTrackerPile.length}! Can you beat it in fewer levels?`\n    );\n    render(newState);\n    return;\n  }\n\n  // Continue normal flow\n  newState.phase = \"explore\";\n  newState.log.unshift(\n    `Advanced to level ${newState.levelTrackerPile.length}.`\n  );\n  console.log(\n    `Advanced to level ${newState.levelTrackerPile.length}. countCards:`,\n    countCards(newState),\n    newState\n  );\n  render(newState);\n}\n\n//utility function to count cards\nfunction countCards(state) {\n  let cardTotal =\n    state.deckPile.length +\n    state.discardPile.length +\n    state.roomPile.length +\n    state.itemPile.length +\n    state.lootPile.length +\n    state.selectionPile.length +\n    state.levelTrackerPile.length;\n\n  return cardTotal;\n}\n\n//utility function to shuffle\nfunction shuffle(array) {\n  for (let i = array.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [array[i], array[j]] = [array[j], array[i]];\n  }\n}\n//calculate danger outcomes and return them as an object.\nfunction calculateDangerOutcome(state, roomPile) {\n  // Step 1: Sum threats\n  const total = roomPile.reduce(\n    (acc, room) => {\n      acc.attack += room.attack || 0;\n      acc.curse += room.curse || 0;\n      acc.trap += room.trap || 0;\n      return acc;\n    },\n    { attack: 0, curse: 0, trap: 0 }\n  );\n\n  // Step 2: Sum defenses\n  const armor = state.characterSheet.armor + state.tempBuffs.armor;\n  const ward = state.characterSheet.ward + state.tempBuffs.ward;\n  const detectTraps =\n    state.characterSheet.detectTraps + state.tempBuffs.detectTraps;\n\n  // Step 3: Calculate difference\n  const dangerDiff = (danger, stat) => Math.max(0, danger - stat);\n\n  const diffAttack = dangerDiff(total.attack, armor);\n  const diffCurse = dangerDiff(total.curse, ward);\n  const diffTrap = dangerDiff(total.trap, detectTraps);\n\n  const totalIncoming = diffAttack + diffCurse + diffTrap;\n\n  // Step 4: Log the outcome\n  const logMessage =\n    `Total Threats: Attack: ${total.attack}, Curse: ${total.curse}, Trap: ${total.trap}. ` +\n    `Stats - Armor: ${armor}, Ward: ${ward}, Detect Traps: ${detectTraps}. ` +\n    `Differences - Attack: ${diffAttack}, Curse: ${diffCurse}, Trap: ${diffTrap}. ` +\n    `Total Incoming Damage: ${totalIncoming}.`;\n\n  console.log(logMessage);\n\n  return {\n    threats: total,\n    stats: { armor, ward, detectTraps },\n    diff: { attack: diffAttack, curse: diffCurse, trap: diffTrap },\n    totalIncoming,\n  };\n}\n\nfunction death(state) {\n  let newState = { ...state };\n  newState.log.unshift(\n    \"You have died on level \" +\n      newState.levelTrackerPile.length +\n      \". Game Over!\"\n  );\n  newState.phase = \"death\"; // set phase to death\n  render(newState);\n  return newState;\n}\n\nfunction explore(state) {\n  if (state.roomPile.length >= 5) {\n    console.log(\"Room limit reached (5). Can't explore more.\");\n    return;\n  }\n  //  copy state\n  let newState = { ...state };\n\n  //move 3 or all from deck to room selection pile\n  const numToDraw = Math.min(3, newState.deckPile.length);\n  for (let i = 0; i < numToDraw; i++) {\n    const card = { ...newState.deckPile.shift() }; // clone each card\n    newState.selectionPile.push(card);\n  }\n\n  console.log(\"selection pile \" + newState.selectionPile[0].roomName);\n\n  //third card is face down\n  if (newState.selectionPile[2]) {\n    newState.selectionPile[2].faceDown = true;\n  }\n\n  //check triggers\n  newState = checkRoomRevealTriggers(newState);\n\n  //advance game phase\n  newState.phase = \"roomSelect\";\n\n  //log the rooms that were offered.\n  let logMessage = \"Rooms offered: \";\n  newState.selectionPile.forEach((room, index) => {\n    if (room.faceDown) {\n      logMessage += ` ??? (Face Down), `;\n    } else {\n      logMessage += ` ${room.roomName}, `;\n    }\n  });\n  newState.log.unshift(logMessage);\n\n  //render the new state\n\n  render(newState);\n}\n\nfunction checkRoomRevealTriggers(state) {\n  let newState = { ...state };\n  newState.selectionPile.forEach((room) => {\n    if (!room.faceDown) {\n      newState = applyRoomRevealEffect(room, newState);\n    }\n  });\n  return newState;\n}\nfunction checkRoomRevealTriggersForRoomPile(state) {\n  let newState = { ...state };\n  newState.roomPile.forEach((room) => {\n    if (!room.faceDown) {\n      newState = applyRoomRevealEffect(room, newState);\n    }\n  });\n  return newState;\n}\nfunction applyRoomRevealEffect(room, state) {\n  let newState = { ...state };\n\n  if (!room.effectOnRoomReveal) return newState;\n\n  if (\n    room.effect === \"discard a random item from belt\" &&\n    newState.itemPile.length > 0\n  ) {\n    const cursedNames = [\n      \"Ashes\",\n      \"Burning Coals\",\n      \"Cursed Paw\",\n      \"Cursed Idol\",\n      \"Cursed Thorn\",\n      \"Demonic Rune\",\n    ];\n    const cursedIndex = newState.itemPile.findIndex((item) =>\n      cursedNames.includes(item.itemName)\n    );\n\n    let discardedItem;\n    if (cursedIndex !== -1) {\n      discardedItem = newState.itemPile.splice(cursedIndex, 1)[0];\n    } else {\n      const randomIndex = Math.floor(Math.random() * newState.itemPile.length);\n      discardedItem = newState.itemPile.splice(randomIndex, 1)[0];\n    }\n\n    newState.discardPile.push(discardedItem);\n    newState = itemDropTriggerCheck(newState, discardedItem, room.roomName);\n  }\n\n  if (room.effect === \"lose HP\") {\n    newState.characterSheet.hp -= room.hpLoss || 3; // default to 3 if not specified\n    newState.log.unshift(\n      \"Lost \" + room.hpLoss + \" HP from \" + room.roomName + \" effect.\"\n    );\n    newState = checkDeath(newState);\n  }\n  if (room.effect === \"lose special HP\") {\n    let stairCollapseDamage = Math.floor(newState.levelTrackerPile.length / 2);\n\n    stairCollapseDamage = Math.max(stairCollapseDamage - 5, 1);\n    newState.characterSheet.hp -= stairCollapseDamage;\n    newState.log.unshift(\n      \"Lost \" + stairCollapseDamage + \" HP from \" + room.roomName + \" effect.\"\n    );\n    newState = checkDeath(newState);\n  }\n\n  if (room.effect === \"nerf if player has ashes or coals\") {\n    const hasAshes = newState.itemPile.some(\n      (item) => item.itemName === \"Ashes\"\n    );\n    const hasCoals = newState.itemPile.some(\n      (item) => item.itemName === \"Burning Coals\"\n    );\n    if (hasAshes || hasCoals) {\n      newState.log.unshift(`The golems appreciate your devotion.`);\n      room.attack -= 10;\n      room.curse -= 5;\n    }\n  }\n\n  if (room.effect === \"discard all of player's cursed items\") {\n    const cursedItems = newState.itemPile.filter((item) =>\n      [\"Cursed Thorn\", \"Cursed Idol\", \"Cursed Paw\"].includes(item.itemName)\n    );\n    if (cursedItems.length > 0) {\n      cursedItems.forEach((item) => {\n        newState.itemPile = newState.itemPile.filter((i) => i !== item);\n        newState.discardPile.push(item);\n        newState.log.unshift(`Discarded cursed item: ${item.itemName}.`);\n        newState = itemDropTriggerCheck(newState, item, room.roomName);\n      });\n    } else {\n      newState.log.unshift(\"No cursed items to discard.\");\n    }\n  }\n\n  return newState;\n}\n\nfunction checkDeath(state) {\n  let newState = { ...state };\n  if (newState.characterSheet.hp <= 0) {\n    return death(newState);\n  }\n  return newState;\n}\n\n//this function handles a player clicking on one of the 3 rooms from the selection pile while in the roomSelect phase.\n//the chosen room (indicated by index number) is moved from the selectionPile to the roomPile, and the other two are placed on the bottom of the deckPile in a random order.\nfunction selectRoomFromPile(state, index) {\n  let newState = { ...state };\n\n  // Move the selected room to roomPile\n  const selectedRoom = newState.selectionPile.splice(index, 1)[0];\n  newState.roomPile.push(selectedRoom);\n\n  //log chosen room\n  if (selectedRoom.faceDown) {\n    newState.log.unshift(`Selected room: ???.`);\n  } else {\n    newState.log.unshift(`Selected room: ${selectedRoom.roomName}.`);\n  }\n\n  // Shuffle the remaining two, turn them face-up, and place them on the bottom of the deckPile\n  const unchosenRooms = [...newState.selectionPile];\n  shuffle(unchosenRooms);\n  unchosenRooms.forEach((card) => {\n    card.faceDown = false;\n  });\n  newState.deckPile = newState.deckPile.concat(unchosenRooms);\n\n  // Clear the selection pile\n  newState.selectionPile = [];\n\n  // Reset phase to explore\n  newState.phase = \"explore\";\n\n  render(newState);\n}\n\n//venture forth into the current configuration of explored rooms.\n\nfunction venture(state) {\n  let newState = { ...state };\n\n  // 1. Add one secret room to roomPile\n  if (newState.deckPile.length > 0) {\n    const secretRoom = { ...newState.deckPile.shift(), faceDown: true };\n    newState.roomPile.push(secretRoom);\n  }\n\n  // 1.5 Reveal all face-down rooms\n  newState.roomPile.forEach((room) => {\n    if (room.faceDown) {\n      room.faceDown = false;\n    }\n  });\n\n  // 2. Calculate danger\n  const danger = calculateDangerOutcome(newState, newState.roomPile);\n  const damageTaken = danger.totalIncoming;\n\n  // 3. Apply damage\n  newState.characterSheet.hp -= damageTaken;\n\n  //log the rooms explored.\n  newState.log.unshift(\n    `Ventured through: ${newState.roomPile\n      .map((room) => (room.faceDown ? \"???\" : room.roomName))\n      .join(\", \")}.`\n  );\n  //log the damage taken from each damage type.\n  newState.log.unshift(\n    `Damage taken: Attack: ${danger.diff.attack}, Curse: ${danger.diff.curse}, Trap: ${danger.diff.trap}, Total: ${damageTaken}.`\n  );\n\n  // 4. Check if player is dead\n  if (newState.characterSheet.hp <= 0) {\n    death(newState);\n  } else {\n    // Victory check: deck is empty and player is alive\n    if (newState.deckPile.length === 0) {\n      newState.phase = \"victory\";\n      newState.log.unshift(\n        `You have survived the donjon! Victory at level ${newState.levelTrackerPile.length}!`\n      );\n      render(newState);\n      return;\n    }\n\n    // If not victory, proceed to loot\n    newState.tempBuffs = {\n      armor: 0,\n      ward: 0,\n      detectTraps: 0,\n    };\n\n    loot(newState);\n  }\n}\n\n// Loot phase where player can choose an item from lootPile\n\nfunction loot(state) {\n  let newState = { ...state };\n  //sets the phase to \"loot\" .\n  newState.phase = \"loot\";\n  //randomly discards a single card from the roomPile.\n  if (newState.roomPile.length > 0) {\n    const randomIndex = Math.floor(Math.random() * newState.roomPile.length);\n    const discardedRoom = newState.roomPile.splice(randomIndex, 1)[0];\n    newState.discardPile.push(discardedRoom);\n    console.log(`Discarded room: ${discardedRoom.roomName}`);\n  }\n  //next, it moves all the remaining cards from the roomPile to the lootPile.\n  newState.lootPile = newState.lootPile.concat(newState.roomPile);\n  newState.roomPile = [];\n  render(newState);\n}\n\n// This function handles picking an item from the lootPile, assigned to the buttons created in render.\nfunction pickItem(state, index) {\n  let newState = { ...state };\n  //the selected item is moved from the lootPile to the itemPile\n  const selectedItem = newState.lootPile.splice(index, 1)[0];\n  if (selectedItem.autoUseOnLoot) {\n    newState = itemPickupTriggerCheck(newState, selectedItem);\n\n    // Check if dead, and STOP if so\n    if (newState.phase === \"death\") return;\n\n    console.log(`Auto-used item: ${selectedItem.itemName}`);\n    return advanceLevel(newState); // Proceed to next level after auto-use\n  }\n  newState.itemPile.push(selectedItem);\n  //log the item pickup\n  newState.log.unshift(`Picked up item: ${selectedItem.itemName}.`);\n  //the remaining items are all discarded.\n  newState.discardPile = newState.discardPile.concat(newState.lootPile);\n  newState.lootPile = [];\n\n  //check for item pickup triggers\n  newState = itemPickupTriggerCheck(newState, selectedItem);\n  newState = checkDeath(newState);\n\n  // Check if dead, and STOP if so\n  if (newState.phase === \"death\") return;\n\n  advanceLevel(newState);\n}\n\n//checks for effects and stat mods on equipping or picking up an item.\nfunction itemPickupTriggerCheck(state, item) {\n  let newState = { ...state };\n  //check for stat boost items\n  if (!item.consumable) {\n    if (item.armor) {\n      newState.characterSheet.armor += item.armor;\n    }\n    if (item.ward) {\n      newState.characterSheet.ward += item.ward;\n    }\n    if (item.detectTraps) {\n      newState.characterSheet.detectTraps += item.detectTraps;\n    }\n  }\n  if (item.heals && item.autoUseOnLoot) {\n    newState.characterSheet.hp += item.heals;\n    // Ensure HP does not exceed max (e.g., 30)\n    newState.characterSheet.hp = Math.min(newState.characterSheet.hp, 30);\n    // Log the healing\n    newState.log.unshift(\n      `Healed for ${item.heals}. Current HP: ${newState.characterSheet.hp}`\n    );\n    newState.discardPile.push(item); // Auto-use items are discarded after use\n  }\n  if (item.injuresOnLoot) {\n    newState.characterSheet.hp -= item.injuresOnLoot;\n    newState.log.unshift(\n      `The ${item.itemName} injured you for ${item.injuresOnLoot} HP.`\n    );\n    newState = checkDeath(newState);\n  }\n  console.log(\"checking pickup triggers for \" + item.itemName);\n  newState = checkDeath(newState);\n\n  return newState;\n}\n\n//checks for effects and stat drops on dropping an item. - to be expanded.\nfunction itemDropTriggerCheck(state, item, roomName) {\n  let newState = { ...state };\n  //check for stat drop items\n  console.log(\"checking drop triggers for \" + item.itemName);\n  if (!item.consumable) {\n    if (item.armor) {\n      newState.characterSheet.armor -= item.armor;\n    }\n    if (item.ward) {\n      newState.characterSheet.ward -= item.ward;\n    }\n    if (item.detectTraps) {\n      newState.characterSheet.detectTraps -= item.detectTraps;\n    }\n  }\n  // Log the item drop\n  newState.log.unshift(\n    `Exploring ${roomName} caused item: ${item.itemName} to be destroyed.`\n  );\n  return newState;\n}\n\nfunction useConsumable(state, itemIndex) {\n  let newState = { ...state };\n\n  // Clone itemPile to avoid mutation\n  let consumable = newState.itemPile[itemIndex];\n  if (!consumable || !consumable.consumable) return newState;\n\n  // Apply effects\n  if (consumable.armor) {\n    newState.tempBuffs.armor += consumable.armor;\n  }\n  if (consumable.ward) {\n    newState.tempBuffs.ward += consumable.ward;\n  }\n  if (consumable.detectTraps) {\n    newState.tempBuffs.detectTraps += consumable.detectTraps;\n  }\n  if (consumable.heals) {\n    newState.characterSheet.hp += consumable.heals;\n    newState.characterSheet.hp = Math.min(newState.characterSheet.hp, 30);\n    newState.log.unshift(\n      `Used ${consumable.itemName}, healed for ${consumable.heals}. HP is now ${newState.characterSheet.hp}`\n    );\n  } else {\n    newState.log.unshift(`Used ${consumable.itemName}.`);\n  }\n\n  // Remove from itemPile and discard it\n  const removed = newState.itemPile.splice(itemIndex, 1)[0];\n  newState.discardPile.push(removed);\n\n  render(newState);\n  return newState;\n}\n\n//main render function of state.\n\nfunction render(state) {\n  const output = document.getElementById(\"output\");\n  output.innerHTML = \"\";\n\n  // HEADER\n  const headerDiv = document.createElement(\"div\");\n  headerDiv.className = \"game-header\";\n\n  const title = document.createElement(\"h1\");\n  title.textContent = \"DONJONSHUFFLE\";\n\n  const subtitle = document.createElement(\"p\");\n  subtitle.innerHTML =\n    \"<em>Try to reach the end of the donjon in the fewest possible levels!</em>\";\n\n  headerDiv.appendChild(title);\n  headerDiv.appendChild(subtitle);\n  output.appendChild(headerDiv);\n\n  // LEVEL\n  const levelDiv = document.createElement(\"div\");\n  levelDiv.className = \"level-info\";\n  levelDiv.textContent = `Level: ${state.levelTrackerPile.length} Donjon: ${state.deckPile.length} Graveyard: ${state.discardPile.length}`;\n  output.appendChild(levelDiv);\n\n  // COMPACT STATS LINE\n  const statsDiv = document.createElement(\"div\");\n  statsDiv.className = \"compact-stats\";\n  statsDiv.innerHTML = `\n    <strong>HP:</strong> ${state.characterSheet.hp} |\n    <strong>Armor:</strong> ${\n      state.characterSheet.armor + state.tempBuffs.armor\n    } |\n    <strong>Ward:</strong> ${state.characterSheet.ward + state.tempBuffs.ward} |\n    <strong>Detect Traps:</strong> ${\n      state.characterSheet.detectTraps + state.tempBuffs.detectTraps\n    }\n  `;\n  output.appendChild(statsDiv);\n\n  // ITEMS\n  const equipment = state.itemPile.filter((i) => !i.consumable);\n  const consumables = state.itemPile.filter((i) => i.consumable);\n\n  const equipmentDiv = document.createElement(\"div\");\n  equipmentDiv.className = \"equipment-block\";\n  equipmentDiv.innerHTML = `<strong>Equipment:</strong><br>`;\n  if (equipment.length === 0) {\n    equipmentDiv.innerHTML += \"None\";\n  } else {\n    equipment.forEach((item) => {\n      const props = [];\n      if (item.armor) props.push(`Armor: ${item.armor}`);\n      if (item.ward) props.push(`Ward: ${item.ward}`);\n      if (item.detectTraps) props.push(`Detect Traps: ${item.detectTraps}`);\n\n      const line =\n        props.length > 0\n          ? `${item.itemName} (${props.join(\", \")})`\n          : `${item.itemName}`;\n\n      equipmentDiv.innerHTML += line + \"<br>\";\n    });\n  }\n  output.appendChild(equipmentDiv);\n\n  const consumablesDiv = document.createElement(\"div\");\n  consumablesDiv.className = \"consumables-block\";\n  consumablesDiv.innerHTML = `<strong>Consumables:</strong> `;\n  if (consumables.length === 0) {\n    consumablesDiv.innerHTML += \"None\";\n  } else {\n    consumables.forEach((item) => {\n      const btn = document.createElement(\"button\");\n      btn.className = \"consumable-button\";\n      btn.textContent = `${item.itemName}`;\n      btn.onclick = () => useConsumable(state, state.itemPile.indexOf(item));\n      consumablesDiv.appendChild(btn);\n    });\n  }\n  output.appendChild(consumablesDiv);\n\n  // CURRENT DUNGEON FLOOR\n  const floorDiv = document.createElement(\"div\");\n  floorDiv.className = \"floor-section\";\n  floorDiv.innerHTML = \"<strong>Current Donjon Floor:</strong><br>\";\n\n  const floorTable = document.createElement(\"table\");\n  floorTable.className = \"floor-table\";\n  state.roomPile.forEach((room) => {\n    const row = document.createElement(\"tr\");\n    row.className = room.faceDown ? \"room-face-down\" : \"room-face-up\";\n\n    if (room.faceDown) {\n      row.innerHTML = `\n    <td class=\"room-name\"><em>???</em></td>\n    <td class=\"room-stat\">ATK: ?</td>\n    <td class=\"room-stat\">CUR: ?</td>\n    <td class=\"room-stat\">TRP: ?</td>\n  `;\n    } else {\n      row.innerHTML = `\n    <td class=\"room-name\">${room.roomName}</td>\n    <td class=\"room-stat\">${room.attack !== 0 ? `ATK: ${room.attack}` : \"\"}</td>\n    <td class=\"room-stat\">${room.curse !== 0 ? `CUR: ${room.curse}` : \"\"}</td>\n    <td class=\"room-stat\">${room.trap !== 0 ? `TRP: ${room.trap}` : \"\"}</td>\n  `;\n    }\n    floorTable.appendChild(row);\n  });\n  floorDiv.appendChild(floorTable);\n  output.appendChild(floorDiv);\n\n  // ROOM SELECTION\n  if (state.phase === \"roomSelect\") {\n    const selectionDiv = document.createElement(\"div\");\n    selectionDiv.className = \"room-selection\";\n    selectionDiv.innerHTML = \"<strong>Select a Room:</strong><br>\";\n    state.selectionPile.forEach((card, index) => {\n      const cardDiv = document.createElement(\"div\");\n      cardDiv.className = \"room-card\";\n\n      if (card.faceDown) {\n        cardDiv.textContent = \"??? (Face Down)\";\n      } else {\n        const lines = [`<strong>${card.roomName}</strong>`];\n        if (card.attack !== 0) lines.push(`Attack: ${card.attack}`);\n        if (card.curse !== 0) lines.push(`Curse: ${card.curse}`);\n        if (card.trap !== 0) lines.push(`Trap: ${card.trap}`);\n        cardDiv.innerHTML = lines.join(\"<br>\");\n      }\n\n      cardDiv.onclick = () => selectRoomFromPile(state, index);\n      selectionDiv.appendChild(cardDiv);\n    });\n    output.appendChild(selectionDiv);\n  }\n\n  // LOOTING PHASE DISPLAY\n  if (state.phase === \"loot\") {\n    const lootDiv = document.createElement(\"div\");\n    lootDiv.className = \"loot-section\";\n    lootDiv.innerHTML = \"<strong>Choose one item to loot:</strong><br>\";\n\n    state.lootPile.slice(0, 3).forEach((item, index) => {\n      const itemDiv = document.createElement(\"div\");\n      itemDiv.className = \"loot-card\";\n\n      let lines = [`<strong>${item.itemName}</strong>`];\n      if (item.armor) lines.push(`Armor: ${item.armor}`);\n      if (item.ward) lines.push(`Ward: ${item.ward}`);\n      if (item.detectTraps) lines.push(`Detect Traps: ${item.detectTraps}`);\n      if (item.heals) lines.push(`Heals: ${item.heals}`);\n      if (item.consumable) lines.push(`<em>Consumable</em>`);\n\n      itemDiv.innerHTML = lines.join(\"<br>\");\n      itemDiv.onclick = () => pickItem(state, index);\n      lootDiv.appendChild(itemDiv);\n    });\n    output.appendChild(lootDiv);\n  }\n\n  // BUTTONS\n  const buttonDiv = document.createElement(\"div\");\n  buttonDiv.className = \"action-buttons\";\n\n  const exploreBtn = document.createElement(\"button\");\n  exploreBtn.className = \"explore-button\";\n  exploreBtn.textContent = \"Explore\";\n  exploreBtn.disabled =\n    state.phase !== \"explore\" ||\n    state.roomPile.length >= 5 ||\n    state.deckPile.length === 0;\n  exploreBtn.onclick = () => explore(state);\n  buttonDiv.appendChild(exploreBtn);\n\n  const ventureBtn = document.createElement(\"button\");\n  ventureBtn.className = \"venture-button\";\n  ventureBtn.textContent = \"Venture\";\n  ventureBtn.disabled =\n    state.phase !== \"explore\" || state.roomPile.length === 0;\n  ventureBtn.onclick = () => venture(state);\n  buttonDiv.appendChild(ventureBtn);\n\n  output.appendChild(buttonDiv);\n\n  // LOG AREA\n  const logDiv = document.createElement(\"div\");\n  logDiv.className = \"log-container\";\n  logDiv.innerHTML = \"<strong>Log: </strong><br>\";\n  const logMessages = state.log.slice(0, 10);\n  logMessages.forEach((msg, index) => {\n    const logEntry = document.createElement(\"div\");\n    logEntry.className = \"log-entry\";\n    if (index === 0) {\n      logEntry.classList.add(\"log-entry-top\");\n    }\n    logEntry.style.opacity = Math.max(1 - index * 0.1, 0.1);\n    logEntry.textContent = msg;\n    logDiv.appendChild(logEntry);\n  });\n  output.appendChild(logDiv);\n\n  // NEW GAME BUTTON\n  //give it a div\n  const newGameDiv = document.createElement(\"div\");\n  newGameDiv.className = \"new-game-container\";\n  output.appendChild(newGameDiv);\n  const newGameBtn = document.createElement(\"button\");\n  newGameBtn.className = \"new-game-button\";\n  newGameBtn.textContent = \"New Game\";\n  newGameBtn.onclick = newGame;\n  output.appendChild(newGameBtn);\n\n  //DEATH PHASE MODIFICATIONS\n  if (state.phase === \"death\") {\n    document.querySelectorAll(\"button:not(.new-game-button)\").forEach((btn) => {\n      btn.disabled = true;\n    });\n  }\n  if (state.phase === \"death\") {\n    document.querySelectorAll(\".log-entry\").forEach((entry) => {\n      entry.classList.add(\"faded-log\");\n    });\n  }\n  if (state.phase === \"death\") {\n    document\n      .querySelectorAll(\"#output > *:not(.new-game-button)\")\n      .forEach((el) => {\n        el.style.opacity = \"0.5\";\n      });\n  }\n\n  //VICTORY PHASE MODIFICATIONS\n  if (state.phase === \"victory\") {\n    document.querySelectorAll(\"button:not(.new-game-button)\").forEach((btn) => {\n      btn.disabled = true;\n    });\n    document.querySelectorAll(\".log-entry\").forEach((entry) => {\n      entry.style.color = \"green\"; // Make log text green\n    });\n    document\n      .querySelectorAll(\"#output > *:not(.new-game-button)\")\n      .forEach((el) => {\n        el.style.opacity = \"0.5\";\n      });\n  }\n}\n\nwindow.onload = () => {\n  newGame();\n};\n"]}